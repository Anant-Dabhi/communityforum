!function() {
    "use strict";
    function i(e, t) {
        return typeof t === e;
    }
    var pe = i.bind(null, "string"), Be = i.bind(null, "undefined"), $e = i.bind(null, "function"), a = i.bind(null, "number");
    function l(e) {
        return !Object.keys(e).length;
    }
    function Ye(e, t) {
        var n = e === !!e, o = n ? 2 : 1, r = n ? t : e, i = n && e;
        function a(e) {
            return null !== e && "object" == typeof e && Object.getPrototypeOf(e) === Object.prototype;
        }
        for (;o < arguments.length; o++) {
            var l, s = arguments[o];
            for (l in s) {
                var c, u, d = r[l], f = s[l];
                Be(f) || "__proto__" !== l && "constructor" !== l && (u = a(f), 
                c = Array.isArray(f), i && (u || c) ? (u = a(d) === u && Array.isArray(d) === c, 
                r[l] = Ye(!0, u ? d : c ? [] : {}, f)) : r[l] = f);
            }
        }
        return r;
    }
    function Ge(e, t) {
        t = e.indexOf(t);
        -1 < t && e.splice(t, 1);
    }
    function me(t, n) {
        if (Array.isArray(t) || "length" in t && a(t.length)) for (let e = 0; e < t.length; e++) n(e, t[e]); else Object.keys(t).forEach(function(e) {
            n(e, t[e]);
        });
    }
    var s = {}, he = 1, ge = 3, c = 8;
    function r(e) {
        return e = parseFloat(e), isFinite(e) ? e : 0;
    }
    function ve(e, t, n) {
        var o = (n || document).createElement(e);
        return me(t || {}, function(e, t) {
            "style" === e ? o.style.cssText = t : e in o ? o[e] = t : o.setAttribute(e, t);
        }), o;
    }
    function u(e, t) {
        for (var n = e || {}; (n = n.parentNode) && !/(9|11)/.test(n.nodeType); ) if (!t || Ne(n, t)) return n;
    }
    function ye(e, t) {
        return Ne(e, t) ? e : u(e, t);
    }
    function be(e) {
        e.parentNode && e.parentNode.removeChild(e);
    }
    function xe(e, t) {
        e.appendChild(t);
    }
    function we(e, t) {
        return e.querySelectorAll(t);
    }
    function Te(n, e, o, r, i) {
        e.split(" ").forEach(function(e) {
            var t;
            pe(o) ? (t = r["_sce-event-" + e + o] || function(e) {
                for (var t = e.target; t && t !== n; ) {
                    if (Ne(t, o)) return void r.call(t, e);
                    t = t.parentNode;
                }
            }, r["_sce-event-" + e + o] = t) : (t = o, i = r), n.addEventListener(e, t, i || !1);
        });
    }
    function Ee(n, e, o, r, i) {
        e.split(" ").forEach(function(e) {
            var t;
            pe(o) ? t = r["_sce-event-" + e + o] : (t = o, i = r), n.removeEventListener(e, t, i || !1);
        });
    }
    function Ce(e, t, n) {
        if (arguments.length < 3) return e.getAttribute(t);
        null == n ? Se(e, t) : e.setAttribute(t, n);
    }
    function Se(e, t) {
        e.removeAttribute(t);
    }
    function qe(e) {
        De(e, "display", "none");
    }
    function Xe(e) {
        De(e, "display", "");
    }
    function Ke(e) {
        (et(e) ? qe : Xe)(e);
    }
    function De(n, e, t) {
        if (arguments.length < 3) {
            if (pe(e)) return 1 === n.nodeType ? getComputedStyle(n)[e] : null;
            me(e, function(e, t) {
                De(n, e, t);
            });
        } else {
            var o = (t || 0 === t) && !isNaN(t);
            n.style[e] = o ? t + "px" : t;
        }
    }
    function d(e, t, n) {
        var o = arguments.length, r = {};
        if (e.nodeType === he) return 1 === o ? (me(e.attributes, function(e, t) {
            /^data\-/i.test(t.name) && (r[t.name.substr(5)] = t.value);
        }), r) : 2 === o ? Ce(e, "data-" + t) : void Ce(e, "data-" + t, String(n));
    }
    function Ne(e, t) {
        var n = !1;
        return n = e && e.nodeType === he ? (e.matches || e.msMatchesSelector || e.webkitMatchesSelector).call(e, t) : n;
    }
    function ke(e, t) {
        t.parentNode.insertBefore(e, t);
    }
    function f(e) {
        return e.className.trim().split(/\s+/);
    }
    function Ae(e, t) {
        return Ne(e, "." + t);
    }
    function _e(e, t) {
        var n = f(e);
        n.indexOf(t) < 0 && n.push(t), e.className = n.join(" ");
    }
    function Ze(e, t) {
        var n = f(e);
        Ge(n, t), e.className = n.join(" ");
    }
    function Me(e, t, n) {
        ((n = Be(n) ? !Ae(e, t) : n) ? _e : Ze)(e, t);
    }
    function Je(e, t) {
        var n, o;
        if (Be(t)) return n = r((o = getComputedStyle(e)).paddingLeft) + r(o.paddingRight), 
        o = r(o.borderLeftWidth) + r(o.borderRightWidth), e.offsetWidth - n - o;
        De(e, "width", t);
    }
    function Re(e, t) {
        var n, o;
        if (Be(t)) return n = r((o = getComputedStyle(e)).paddingTop) + r(o.paddingBottom), 
        o = r(o.borderTopWidth) + r(o.borderBottomWidth), e.offsetHeight - n - o;
        De(e, "height", t);
    }
    function Qe(e, t, n) {
        var o;
        $e(window.CustomEvent) ? o = new CustomEvent(t, {
            bubbles: !0,
            cancelable: !0,
            detail: n
        }) : (o = e.ownerDocument.createEvent("CustomEvent")).initCustomEvent(t, !0, !0, n), 
        e.dispatchEvent(o);
    }
    function et(e) {
        return e.getClientRects().length;
    }
    function p(e, t, n, o, r) {
        for (e = r ? e.lastChild : e.firstChild; e; ) {
            var i = r ? e.previousSibling : e.nextSibling;
            if (!n && !1 === t(e) || !o && !1 === p(e, t, n, o, r) || n && !1 === t(e)) return !1;
            e = i;
        }
    }
    function tt(e, t, n, o) {
        p(e, t, n, o, !0);
    }
    function nt(e, t) {
        var n = (t = t || document).createDocumentFragment(), o = ve("div", {}, t);
        for (o.innerHTML = e; o.firstChild; ) xe(n, o.firstChild);
        return n;
    }
    function ot(e) {
        return e && (!Ne(e, "p,div") || e.className || Ce(e, "style") || !l(d(e)));
    }
    function rt(e, t) {
        var n = ve(t, {}, e.ownerDocument);
        for (me(e.attributes, function(e, t) {
            try {
                Ce(n, t.name, t.value);
            } catch (e) {}
        }); e.firstChild; ) xe(n, e.firstChild);
        return e.parentNode.replaceChild(n, e), n;
    }
    var m = "|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|details|section|article|aside|nav|main|header|hgroup|footer|fieldset|dl|dt|dd|figure|figcaption|";
    function it(e) {
        return !!/11?|9/.test(e.nodeType) && "|iframe|area|base|basefont|br|col|frame|hr|img|input|wbr|isindex|link|meta|param|command|embed|keygen|source|track|object|".indexOf(`|${e.nodeName.toLowerCase()}|`) < 0;
    }
    function Le(e, t) {
        var n = (e || {}).nodeType || ge;
        return n !== he ? n === ge : "code" === (n = e.tagName.toLowerCase()) ? !t : m.indexOf(`|${n}|`) < 0;
    }
    function h(e) {
        return e.lastChild && h(e.lastChild) && be(e.lastChild), 3 === e.nodeType ? !e.nodeValue : it(e) && !e.childNodes.length;
    }
    function at(e) {
        p(e, function(t) {
            var n = !Le(t, !0) && t.nodeType !== c, o = t.parentNode;
            if (n && (Le(o, !0) || "P" === o.tagName)) {
                let e = t;
                for (;Le(e.parentNode, !0) || "P" === e.parentNode.tagName; ) e = e.parentNode;
                for (var r = v(e, t), i = t; o && Le(o, !0); ) {
                    if (o.nodeType === he) {
                        for (var a = o.cloneNode(); i.firstChild; ) xe(a, i.firstChild);
                        xe(i, a);
                    }
                    o = o.parentNode;
                }
                ke(i, e), h(r) || ke(r, i), h(e) && be(e);
            }
            if (n && Ne(t, "ul,ol") && Ne(t.parentNode, "ul,ol")) {
                r = "li", n = (n = t).previousElementSibling;
                let e = !r || !n || Ne(n, r) ? n : null;
                e || ke(e = ve("li"), t), xe(e, t);
            }
        });
    }
    function g(e, t) {
        return e ? (t ? e.previousSibling : e.nextSibling) || g(e.parentNode, t) : null;
    }
    function lt(e) {
        var t, n, o, r, i, a, l = De(e, "whiteSpace"), s = /line$/i.test(l), c = e.firstChild;
        if (!/pre(\-wrap)?$/i.test(l)) for (;c; ) {
            if (i = c.nextSibling, t = c.nodeValue, (n = c.nodeType) === he && c.firstChild && lt(c), 
            n === ge) {
                for (n = g(c), o = g(c, !0), a = !1; Ae(o, "sceditor-ignore"); ) o = g(o, !0);
                if (Le(c) && o) {
                    for (r = o; r.lastChild; ) for (r = r.lastChild; Ae(r, "sceditor-ignore"); ) r = g(r, !0);
                    a = r.nodeType === ge ? /[\t\n\r ]$/.test(r.nodeValue) : !Le(r);
                }
                t = t.replace(/\u200B/g, ""), o && Le(o) && !a || (t = t.replace(s ? /^[\t ]+/ : /^[\t\n\r ]+/, "")), 
                (t = n && Le(n) ? t : t.replace(s ? /[\t ]+$/ : /[\t\n\r ]+$/, "")).length ? c.nodeValue = t.replace(s ? /[\t ]+/g : /[\t\n\r ]+/g, " ") : be(c);
            }
            c = i;
        }
    }
    function v(e, t) {
        var n = e.ownerDocument.createRange();
        return n.setStartBefore(e), n.setEndAfter(t), n.extractContents();
    }
    function st(e) {
        for (var t = 0, n = 0; e; ) t += e.offsetLeft, n += e.offsetTop, e = e.offsetParent;
        return {
            left: t,
            top: n
        };
    }
    function y(e, t) {
        var n = e.style;
        return s[t] || (s[t] = t.replace(/^-ms-/, "ms-").replace(/-(\w)/g, function(e, t) {
            return t.toUpperCase();
        })), n = n[t = s[t]], "textAlign" === t && (n = n || De(e, t), De(e.parentNode, t) === n || "block" !== De(e, "display") || Ne(e, "hr,th")) ? "" : n;
    }
    function ct(e, t) {
        var n = e.attributes.length;
        if (n === t.attributes.length) {
            for (;n--; ) {
                var o = e.attributes[n];
                if ("style" === o.name ? !function(e, t) {
                    var n = e.style.length;
                    if (n === t.style.length) {
                        for (;n--; ) {
                            var o = e.style[n];
                            if (e.style[o] !== t.style[o]) return;
                        }
                        return 1;
                    }
                }(e, t) : o.value !== Ce(t, o.name)) return;
            }
            return 1;
        }
    }
    function ut(e) {
        for (;e.firstChild; ) ke(e.firstChild, e);
        be(e);
    }
    var dt = {
        toolbar: "bold,italic,underline,strike|font,size,color|mark|email,link,unlink,quote,code|image|bulletlist,orderedlist|left,center,right|indent,outdent|cut,copy,pastetext,removeformat|undo,redo|youtube,media,extensions|source",
        toolbarExclude: null,
        maxLength: null,
        styles: [],
        themeMode: Ce(document.documentElement, "data-bs-theme") || "dark",
        fonts: "Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",
        format: "bbcode",
        icons: "fontawesome",
        codeLanguages: [ {
            Value: "markup",
            Text: "Plain Text"
        }, {
            Value: "bash",
            Text: "Bash(shell)"
        }, {
            Value: "c",
            Text: "C"
        }, {
            Value: "cpp",
            Text: "C++"
        }, {
            Value: "csharp",
            Text: "C#"
        }, {
            Value: "css",
            Text: "CSS"
        }, {
            Value: "scss",
            Text: "SCSS"
        }, {
            Value: "git",
            Text: "Git"
        }, {
            Value: "markup",
            Text: "HTML"
        }, {
            Value: "java",
            Text: "Java"
        }, {
            Value: "javascript",
            Text: "JavaScript"
        }, {
            Value: "json",
            Text: "JSON"
        }, {
            Value: "python",
            Text: "Python"
        }, {
            Value: "sql",
            Text: "SQL"
        }, {
            Value: "markup",
            Text: "XML"
        }, {
            Value: "vb",
            Text: "Visual Basic"
        } ],
        colors: "#000000,#44B8FF,#1E92F7,#0074D9,#005DC2,#00369B,#b3d5f4|#444444,#C3FFFF,#9DF9FF,#7FDBFF,#68C4E8,#419DC1,#d9f4ff|#666666,#72FF84,#4CEA5E,#2ECC40,#17B529,#008E02,#c0f0c6|#888888,#FFFF44,#FFFA1E,#FFDC00,#E8C500,#C19E00,#fff5b3|#aaaaaa,#FFC95F,#FFA339,#FF851B,#E86E04,#C14700,#ffdbbb|#cccccc,#FF857A,#FF5F54,#FF4136,#E82A1F,#C10300,#ffc6c3|#eeeeee,#FF56FF,#FF30DC,#F012BE,#D900A7,#B20080,#fbb8ec|#ffffff,#F551FF,#CF2BE7,#B10DC9,#9A00B2,#9A00B2,#e8b6ef",
        locale: Ce(document.documentElement, "lang") || "en",
        charset: "utf-8",
        width: "100%",
        height: null,
        resizeEnabled: !0,
        resizeMinWidth: null,
        resizeMinHeight: null,
        resizeMaxHeight: null,
        resizeMaxWidth: null,
        resizeHeight: !0,
        resizeWidth: !0,
        dateFormat: "year-month-day",
        toolbarContainer: null,
        enablePasteFiltering: !1,
        disablePasting: !1,
        readOnly: !1,
        rtl: !1,
        autofocus: !1,
        autofocusEnd: !0,
        autoExpand: !1,
        autoUpdate: !1,
        spellcheck: !0,
        runWithoutWysiwygSupport: !1,
        startInSourceMode: !1,
        id: null,
        plugins: "undo,dragdrop",
        zIndex: null,
        bbcodeTrim: !1,
        disableBlockRemove: !1,
        allowedIframeUrls: [],
        parserOptions: {},
        dropDownCss: {},
        allowedTags: [],
        allowedAttributes: [],
        extensionsUrl: "",
        root: ""
    }, b = /^(https?|s?ftp|mailto|spotify|skype|ssh|teamspeak|tel):|(\/\/)|data:image\/(png|bmp|gif|p?jpe?g);/i;
    function x(e) {
        return e.replace(/([\-.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
    }
    function Oe(e, t) {
        var n;
        return e && (!(n = {
            "&": "&amp;",
            "<": "&lt;",
            ">": "&gt;",
            "  ": "&nbsp; ",
            "\r\n": "<br />",
            "\r": "<br />",
            "\n": "<br />"
        }) !== t && (n['"'] = "&#34;", n["'"] = "&#39;", n["`"] = "&#96;"), e = e.replace(/ {2}|\r\n|[&<>\r\n'"`]/g, function(e) {
            return n[e] || e;
        })), e;
    }
    var w = {
        html: '<!DOCTYPE html><html data-bs-theme="{themeMode}"><head><meta http-equiv="Content-Type" content="text/html;charset={charset}" />{styles}</head><body contenteditable="true" {spellcheck}><p></p></body></html>',
        style: '<link rel="stylesheet" type="text/css" href="{style}" />',
        toolbarButton: '<a class="btn sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><span unselectable="on">  </span></a>',
        codeOpt: '<a class="sceditor-font-option dropdown-item" href="#" data-language="{language}">{languageName}</a>',
        extensionOpt: '<a class="sceditor-extension-option dropdown-item" href="#" data-language="{extension}">{extension}</a>',
        fontOpt: '<a class="sceditor-font-option dropdown-item" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',
        sizeOpt: '<a class="sceditor-fontsize-option dropdown-item" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',
        albums: '<form class="m-3"><div class="AlbumsListMenu"><div id="AlbumsListBox" class="content"><div id="AlbumsListPager"></div><div id="PostAlbumsLoader" class="text-center"><div class="fa-3x"><i class="fas fa-spinner fa-pulse"></i></div></div><div id="AlbumsListBox" class="content"><div id="PostAlbumsListPlaceholder" data-url="{root}" style="clear: both; "><ul class="AlbumsList list-group"></ul></div></div></form>',
        attachments: '<form class="m-3"><div class="AttachmentListMenu"><div id="AttachmentsListBox" class="content"><div id="AttachmentsListPager"></div><div id="PostAttachmentLoader" class="text-center"><div class="fa-3x"><i class="fas fa-spinner fa-pulse"></i></div></div><div id="AttachmentsListBox" class="content"><div id="PostAttachmentListPlaceholder" data-url="{root}" style="clear: both; "><ul class="AttachmentList list-group"></ul></div><div class="OpenUploadDialog mt-1 d-grid gap-2"><button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#UploadDialog">Upload</button>"</div></div></form>',
        pastetext: '<form class="m-3"><div class="mb-3"><label for="txt" class="form-label">{label}</label> <textarea cols="20" rows="7" id="txt" class="form-control"></textarea></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></div></form>',
        image: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{url}</label> <input type="text" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><div class="mb-3"><label for="des" class="form-label">{desc}</label> <input type="text" id="des" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></form>',
        email: '<form class="m-3"><div class="mb-3"><label for="email" class="form-label">{label}</label> <input type="text" id="email" dir="ltr" class="form-control" /></div><div class="mb-3"><label for="des" class="form-label">{desc}</label> <input type="text" id="des" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></form>',
        link: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{url}</label> <input type="text" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><div class="mb-3"><label for="des" class="form-label">{desc}</label> <input type="text" id="des" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{ins}" /></form>',
        mediaMenu: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{label}</label> <input type="text" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></form>',
        youtubeMenu: '<form class="m-3"><div class="mb-3"><label for="link" class="form-label">{label}</label> <input type="text" id="link" dir="ltr" placeholder="https://" class="form-control" /></div><input type="button" class="btn btn-sm btn-primary button" value="{insert}" /></form>',
        youtube: '<div data-oembed-url="https://youtube.com/embed/{id}" data-youtube-id="{id}" class="ratio ratio-16x9"><iframe src="https://youtube.com/embed/{id}?hd=1&start={time}"></iframe></div>'
    };
    function Ie(e, t, n) {
        var o = w[e];
        return Object.keys(t).forEach(function(e) {
            o = o.replace(new RegExp(x(`{${e}}`), "g"), t[e]);
        }), o = n ? nt(o) : o;
    }
    function T(n) {
        if ("mozHidden" in document) {
            let e = n.getBody(), t;
            for (;e; ) {
                if ((t = e).firstChild) t = t.firstChild; else {
                    for (;t && !t.nextSibling; ) t = t.parentNode;
                    t = t && t.nextSibling;
                }
                3 !== e.nodeType || !/[\n\r\t]+/.test(e.nodeValue) || /^pre/.test(De(e.parentNode, "whiteSpace")) || be(e), 
                e = t;
            }
        }
    }
    var Fe = {
        albums: {
            exec: function(e) {
                var t = ve("div");
                xe(t, Ie("albums", {
                    root: this.opts.root
                }, !0)), this.createDropDown(e, "albums", t);
                getAlbumImagesData(5, 0, !1);
            },
            tooltip: "User Albums"
        },
        attachments: {
            exec: function(e) {
                var t = ve("div");
                xe(t, Ie("attachments", {
                    root: this.opts.root
                }, !0)), this.createDropDown(e, "attachments", t);
                getPaginationData(5, 0, !1);
            },
            tooltip: "User Attachments"
        },
        bold: {
            exec: "bold",
            tooltip: "Bold",
            shortcut: "Ctrl+B"
        },
        italic: {
            exec: "italic",
            tooltip: "Italic",
            shortcut: "Ctrl+I"
        },
        underline: {
            exec: "underline",
            tooltip: "Underline",
            shortcut: "Ctrl+U"
        },
        strike: {
            exec: "strikethrough",
            tooltip: "Strikethrough"
        },
        mark: {
            exec: function() {
                this.wysiwygEditorInsertHtml("<mark>", "</mark>");
            },
            tooltip: "Highlight",
            shortcut: "Ctrl+H"
        },
        left: {
            state: function(e) {
                var t;
                if (e = e && 3 === e.nodeType ? e.parentNode : e) return t = "ltr" === De(e, "direction"), 
                e = De(e, "textAlign"), /left/.test(e) || e === (t ? "start" : "end");
            },
            exec: "justifyleft",
            tooltip: "Align left"
        },
        center: {
            exec: "justifycenter",
            tooltip: "Center"
        },
        right: {
            state: function(e) {
                var t;
                if (e = e && 3 === e.nodeType ? e.parentNode : e) return t = "ltr" === De(e, "direction"), 
                e = De(e, "textAlign"), /right/.test(e) || e === (t ? "end" : "start");
            },
            exec: "justifyright",
            tooltip: "Align right"
        },
        justify: {
            exec: "justifyfull",
            tooltip: "Justify"
        },
        font: {
            _dropDown: function(t, e, n) {
                var o = ve("div");
                Te(o, "click", "a", function(e) {
                    n(d(this, "font")), t.closeDropDown(!0), e.preventDefault();
                }), t.opts.fonts.split(",").forEach(function(e) {
                    xe(o, Ie("fontOpt", {
                        font: e
                    }, !0));
                }), t.createDropDown(e, "font-picker", o);
            },
            exec: function(e) {
                var t = this;
                Fe.font._dropDown(t, e, function(e) {
                    t.execCommand("fontname", e);
                });
            },
            tooltip: "Font Name"
        },
        size: {
            _dropDown: function(t, e, n) {
                var o = ve("div");
                Te(o, "click", "a", function(e) {
                    n(d(this, "size")), t.closeDropDown(!0), e.preventDefault();
                });
                for (let e = 1; e <= 7; e++) xe(o, Ie("sizeOpt", {
                    size: e
                }, !0));
                t.createDropDown(e, "fontsize-picker", o);
            },
            exec: function(e) {
                var t = this;
                Fe.size._dropDown(t, e, function(e) {
                    t.execCommand("fontsize", e);
                });
            },
            tooltip: "Font Size"
        },
        color: {
            _dropDown: function(t, e, n) {
                var o = ve("div"), r = "", i = Fe.color;
                i._htmlCache || (t.opts.colors.split("|").forEach(function(e) {
                    r += '<div class="sceditor-color-column">', e.split(",").forEach(function(e) {
                        r += `<a href="#" class="sceditor-color-option" style="background-color: ${e}" data-color="${e}"></a>`;
                    }), r += "</div>";
                }), i._htmlCache = r), xe(o, nt(i._htmlCache)), Te(o, "click", "a", function(e) {
                    n(d(this, "color")), t.closeDropDown(!0), e.preventDefault();
                }), t.createDropDown(e, "color-picker", o);
            },
            exec: function(e) {
                var t = this;
                Fe.color._dropDown(t, e, function(e) {
                    t.execCommand("forecolor", e);
                });
            },
            tooltip: "Font Color"
        },
        removeformat: {
            exec: "removeformat",
            tooltip: "Remove Formatting"
        },
        cut: {
            exec: "cut",
            tooltip: "Cut",
            errorMessage: "Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"
        },
        copy: {
            exec: "copy",
            tooltip: "Copy",
            errorMessage: "Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"
        },
        paste: {
            exec: "paste",
            tooltip: "Paste",
            errorMessage: "Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"
        },
        pastetext: {
            exec: function(e) {
                var t, n = ve("div"), o = this;
                xe(n, Ie("pastetext", {
                    label: o._("Paste your text inside the following box:"),
                    insert: o._("Insert")
                }, !0)), Te(n, "click", ".button", function(e) {
                    (t = we(n, "#txt")[0].value) && o.wysiwygEditorInsertText(t), 
                    o.closeDropDown(!0), e.preventDefault();
                }), o.createDropDown(e, "pastetext", n);
            },
            tooltip: "Paste Text"
        },
        bulletlist: {
            exec: function() {
                T(this), this.execCommand("insertunorderedlist");
            },
            tooltip: "Bullet list"
        },
        orderedlist: {
            exec: function() {
                T(this), this.execCommand("insertorderedlist");
            },
            tooltip: "Numbered list"
        },
        indent: {
            state: function(e, t) {
                var n;
                return Ne(t, "li") || Ne(t, "ul,ol,menu") && (n = (t = this.getRangeHelper().selectedRange()).startContainer.parentNode, 
                t = t.endContainer.parentNode, n !== n.parentNode.firstElementChild || Ne(t, "li") && t !== t.parentNode.lastElementChild) ? 0 : -1;
            },
            exec: function() {
                var e = this.getRangeHelper().getFirstBlockParent();
                this.focus(), ye(e, "ul,ol,menu") && this.execCommand("indent");
            },
            tooltip: "Add indent"
        },
        outdent: {
            state: function(e, t) {
                return ye(t, "ul,ol,menu") ? 0 : -1;
            },
            exec: function() {
                ye(this.getRangeHelper().getFirstBlockParent(), "ul,ol,menu") && this.execCommand("outdent");
            },
            tooltip: "Remove one indent"
        },
        code: {
            _dropDown: function(t, e, n) {
                var o = ve("div");
                Te(o, "click", "a", function(e) {
                    n(d(this, "language")), t.closeDropDown(!0), e.preventDefault();
                }), t.opts.codeLanguages.forEach(function(e) {
                    xe(o, Ie("codeOpt", {
                        language: e.Value,
                        languageName: e.Text
                    }, !0));
                }), t.createDropDown(e, "codeLanguage-picker", o);
            },
            exec: function(e) {
                var t = this;
                Fe.code._dropDown(t, e, function(e) {
                    t.wysiwygEditorInsertHtml(`<pre class="border border-danger rounded m-2 p-2"><code class="language-${e}">`, "</code></pre>");
                });
            },
            tooltip: "Code"
        },
        extensions: {
            _dropDown: function(t, e, n) {
                var o = ve("div");
                Te(o, "click", "a", function(e) {
                    n(d(this, "language")), t.closeDropDown(!0), e.preventDefault();
                }), fetch(t.opts.extensionsUrl, {
                    method: "GET"
                }).then(e => e.json()).then(e => {
                    e.forEach(function(e) {
                        e.useToolbar || xe(o, Ie("extensionOpt", {
                            extension: e.name
                        }, !0));
                    });
                }), t.createDropDown(e, "extensions-picker", o);
            },
            exec: function(e) {
                var t = this;
                Fe.extensions._dropDown(t, e, function(e) {
                    t.wysiwygEditorInsertText(`[${e}]`, `[/${e}]`);
                });
            },
            tooltip: "More BBCode"
        },
        image: {
            _dropDown: function(n, e, o) {
                var r = ve("div"), i = (xe(r, Ie("image", {
                    url: n._("URL:"),
                    desc: n._("Description (optional):"),
                    insert: n._("Insert")
                }, !0)), we(r, "#link")[0]);
                function t(e) {
                    var t = we(r, "#des")[0].value;
                    i.value && o(i.value, t), n.closeDropDown(!0), e.preventDefault();
                }
                Te(r, "click", ".button", t), Te(r, "keypress", function(e) {
                    13 === e.which && i.value && t(e);
                }, !0), n.createDropDown(e, "insertimage", r);
            },
            exec: function(e) {
                var o = this;
                Fe.image._dropDown(o, e, function(e, t) {
                    var n = "";
                    t && (n += ` alt="${Oe(t)}"`), n += ` src="${Oe(e)}"`, o.wysiwygEditorInsertHtml(`<img${n} class="img-user-posted img-thumbnail" />`);
                });
            },
            tooltip: "Insert an image"
        },
        email: {
            _dropDown: function(n, e, o) {
                var r = ve("div");
                xe(r, Ie("email", {
                    label: n._("E-mail:"),
                    desc: n._("Description (optional):"),
                    insert: n._("Insert")
                }, !0)), Te(r, "click", ".button", function(e) {
                    var t = we(r, "#email")[0].value;
                    t && o(t, we(r, "#des")[0].value), n.closeDropDown(!0), e.preventDefault();
                }), n.createDropDown(e, "insertemail", r);
            },
            exec: function(e) {
                var n = this;
                Fe.email._dropDown(n, e, function(e, t) {
                    !n.getRangeHelper().selectedHtml() || t ? n.wysiwygEditorInsertHtml(`<a href="mailto:${Oe(e)}">${Oe(t || e)}</a>`) : n.execCommand("createlink", "mailto:" + e);
                });
            },
            tooltip: "Insert an email"
        },
        link: {
            _dropDown: function(t, e, n) {
                var o = ve("div"), r = (xe(o, Ie("link", {
                    url: t._("URL:"),
                    desc: t._("Description (optional):"),
                    ins: t._("Insert")
                }, !0)), we(o, "#link")[0]);
                function i(e) {
                    r.value && n(r.value, we(o, "#des")[0].value), t.closeDropDown(!0), 
                    e.preventDefault();
                }
                Te(o, "click", ".button", i), Te(o, "keypress", function(e) {
                    13 === e.which && r.value && i(e);
                }, !0), t.createDropDown(e, "insertlink", o);
            },
            exec: function(e) {
                var n = this;
                Fe.link._dropDown(n, e, function(e, t) {
                    t || !n.getRangeHelper().selectedHtml() ? n.wysiwygEditorInsertHtml(`<a href="${Oe(e)}">${Oe(t || e)}</a>`) : n.execCommand("createlink", e);
                });
            },
            tooltip: "Insert a link"
        },
        unlink: {
            state: function() {
                return ye(this.currentNode(), "a") ? 0 : -1;
            },
            exec: function() {
                var e = ye(this.currentNode(), "a");
                if (e) {
                    for (;e.firstChild; ) ke(e.firstChild, e);
                    be(e);
                }
            },
            tooltip: "Unlink"
        },
        quote: {
            exec: function(e, t, n) {
                var o = '<div class="card mx-3 mb-3 border-secondary shadow-sm"><div class="card-body"><p class="card-text"><i class="fa fa-quote-left text-primary fs-4 p-2"></i><span class="quote-content">', r = "</span></p></div></div>";
                t ? (o = o + t + (n = n ? `<cite class="card-text text-end d-block"><small class="text-body-secondary">${Oe(n)}</small></cite>` : "") + r, 
                r = null) : "" === this.getRangeHelper().selectedHtml() && (r = "<br />" + r), 
                this.wysiwygEditorInsertHtml(o, r);
            },
            tooltip: "Insert a Quote"
        },
        media: {
            _dropDown: function(n, e, o) {
                var r = ve("div");
                xe(r, Ie("mediaMenu", {
                    label: n._("Media URL:"),
                    insert: n._("Insert")
                }, !0)), Te(r, "click", ".button", function(e) {
                    var t = we(r, "#link")[0].value;
                    o(t), n.closeDropDown(!0), e.preventDefault();
                }), n.createDropDown(e, "insertmedia", r);
            },
            exec: function(e) {
                var t = this;
                Fe.media._dropDown(t, e, function(e) {
                    t.wysiwygEditorInsertHtml(`[media]${e}[/media]`);
                });
            },
            tooltip: "Insert an embed media like a YouTube video, facebook post or twitter status."
        },
        youtube: {
            _dropDown: function(r, e, i) {
                var a = ve("div");
                xe(a, Ie("youtubeMenu", {
                    label: r._("Video URL:"),
                    insert: r._("Insert")
                }, !0)), Te(a, "click", ".button", function(e) {
                    var t = we(a, "#link")[0].value, n = t.match(/(?:v=|v\/|embed\/|youtu.be\/)?([a-zA-Z0-9_-]{11})/), t = t.match(/[&|?](?:star)?t=((\d+[hms]?){1,3})/), o = 0;
                    t && me(t[1].split(/[hms]/), function(e, t) {
                        "" !== t && (o = 60 * o + Number(t));
                    }), n && /^[a-zA-Z0-9_\-]{11}$/.test(n[1]) && i(n[1], o), r.closeDropDown(!0), 
                    e.preventDefault();
                }), r.createDropDown(e, "insertlink", a);
            },
            exec: function(e) {
                var n = this;
                Fe.youtube._dropDown(n, e, function(e, t) {
                    n.wysiwygEditorInsertHtml(Ie("youtube", {
                        id: e,
                        time: t
                    }));
                });
            },
            tooltip: "Insert a YouTube video"
        },
        date: {
            _date: function(e) {
                var t = new Date(), n = t.getYear(), o = t.getMonth() + 1, t = t.getDate();
                return o < 10 && (o = "0" + o), t < 10 && (t = "0" + t), e.opts.dateFormat.replace(/year/i, n = n < 2e3 ? 1900 + n : n).replace(/month/i, o).replace(/day/i, t);
            },
            exec: function() {
                this.insertText(Fe.date._date(this));
            },
            txtExec: function() {
                this.insertText(Fe.date._date(this));
            },
            tooltip: "Insert current date"
        },
        time: {
            _time: function() {
                var e = new Date(), t = e.getHours(), n = e.getMinutes(), e = e.getSeconds();
                return (t = t < 10 ? "0" + t : t) + ":" + (n = n < 10 ? "0" + n : n) + ":" + (e = e < 10 ? "0" + e : e);
            },
            exec: function() {
                this.insertText(Fe.time._time());
            },
            txtExec: function() {
                this.insertText(Fe.time._time());
            },
            tooltip: "Insert current time"
        },
        undo: {
            exec: "undo",
            tooltip: "Undo",
            shortcut: "Ctrl+Z"
        },
        redo: {
            exec: "redo",
            tooltip: "Redo",
            shortcut: "Ctrl+Y"
        },
        maximize: {
            state: function() {
                return this.maximize();
            },
            exec: function() {
                this.maximize(!this.maximize()), this.focus();
            },
            txtExec: function() {
                this.maximize(!this.maximize()), this.focus();
            },
            tooltip: "Maximize",
            shortcut: "Ctrl+Shift+M"
        },
        source: {
            state: function() {
                return this.sourceMode();
            },
            exec: function() {
                this.toggleSourceMode(), this.focus();
            },
            txtExec: function() {
                this.toggleSourceMode(), this.focus();
            },
            tooltip: "View source",
            shortcut: "Ctrl+Shift+S"
        },
        ignore: {}
    }, E = {};
    function ft(i) {
        function a(e) {
            return "signal" + e.charAt(0).toUpperCase() + e.slice(1);
        }
        function e(e, t) {
            e = [].slice.call(e);
            for (var n, o = a(e.shift()), r = 0; r < l.length; r++) if (o in l[r] && (n = l[r][o].apply(i, e), 
            t)) return n;
        }
        var r = this, l = [];
        r.call = function() {
            e(arguments, !1);
        }, r.callOnlyFirst = function() {
            return e(arguments, !0);
        }, r.hasHandler = function(e) {
            var t = l.length;
            for (e = a(e); t--; ) if (e in l[t]) return !0;
            return !1;
        }, r.exists = function(e) {
            return e in E && "function" == typeof (e = E[e]) && "object" == typeof e.prototype;
        }, r.isRegistered = function(t) {
            if (r.exists(t)) {
                let e = l.length;
                for (;e--; ) if (l[e] instanceof E[t]) return !0;
            }
            return !1;
        }, r.register = function(e) {
            return !(!r.exists(e) || r.isRegistered(e) || (e = new E[e](), l.push(e), 
            "init" in e && e.init.call(i), 0));
        }, r.deregister = function(e) {
            var t, n = l.length, o = !1;
            if (r.isRegistered(e)) for (;n--; ) l[n] instanceof E[e] && (o = !0, 
            "destroy" in (t = l.splice(n, 1)[0])) && t.destroy.call(i);
            return o;
        }, r.destroy = function() {
            for (var e = l.length; e--; ) "destroy" in l[e] && l[e].destroy.call(i);
            l = [], i = null;
        };
    }
    ft.plugins = E;
    var C = function(e, t, n) {
        var o, r, i, a, l, s = "", c = e.startContainer, u = e.startOffset;
        for (c && 3 !== c.nodeType && (c = c.childNodes[u], u = 0), i = a = u; n > s.length && c && 3 === c.nodeType; ) o = c.nodeValue, 
        r = n - s.length, l && (a = o.length, i = 0), l = c, c = t ? (u = i = Math.max(a - r, 0), 
        s = o.substr(i, a - i) + s, l.previousSibling) : (u = i + (a = Math.min(r, o.length)), 
        s += o.substr(i, a), l.nextSibling);
        return {
            node: l || c,
            offset: u,
            text: s
        };
    };
    function pt(r, e, i) {
        var a, l, s = e || r.contentDocument || r.document, c = "sceditor-start-marker", u = "sceditor-end-marker", g = this;
        g.insertHTML = function(e, t) {
            var n, o;
            if (!g.selectedRange()) return !1;
            for (t && (e += g.selectedHtml() + t), o = ve("p", {}, s), n = s.createDocumentFragment(), 
            o.innerHTML = i(e); o.firstChild; ) xe(n, o.firstChild);
            g.insertNode(n);
        }, l = function(e, t, n) {
            var o, r = s.createDocumentFragment();
            if ("string" == typeof e ? (t && (e += g.selectedHtml() + t), r = nt(e)) : (xe(r, e), 
            t && (xe(r, g.selectedRange().extractContents()), xe(r, t))), o = r.lastChild) {
                for (;!Le(o.lastChild, !0); ) o = o.lastChild;
                return it(o) ? o.lastChild || xe(o, document.createTextNode("​")) : o = r, 
                g.removeMarkers(), xe(o, a(c)), xe(o, a(u)), n ? (xe(e = ve("div"), r), 
                e.innerHTML) : r;
            }
        }, g.insertNode = function(e, t) {
            var n, o, e = l(e, t), t = g.selectedRange(), r = t.commonAncestorContainer, i = [];
            if (!e) return !1;
            function a(e) {
                e && h(e) && i.indexOf(e) < 0 && be(e);
            }
            t.startContainer !== t.endContainer && (me(r.childNodes, function(e, t) {
                h(t) && i.push(t);
            }), n = e.firstChild, o = e.lastChild), t.deleteContents(), r && 3 !== r.nodeType && !it(r) ? ke(e, r) : (t.insertNode(e), 
            a(n && n.previousSibling), a(o && o.nextSibling)), g.restoreRange();
        }, g.cloneSelected = function() {
            var e = g.selectedRange();
            if (e) return e.cloneRange();
        }, g.selectedRange = function() {
            var e, t, n = r.getSelection();
            if (n) {
                if (n.rangeCount <= 0) {
                    for (t = s.body; t.firstChild; ) t = t.firstChild;
                    (e = s.createRange()).setStartBefore(t), n.addRange(e);
                }
                return e = 0 < n.rangeCount ? n.getRangeAt(0) : e;
            }
        }, g.hasSelection = function() {
            var e = r.getSelection();
            return e && 0 < e.rangeCount;
        }, g.selectedHtml = function() {
            var e, t = g.selectedRange();
            return t ? (xe(e = ve("p", {}, s), t.cloneContents()), e.innerHTML) : "";
        }, g.parentNode = function() {
            var e = g.selectedRange();
            if (e) return e.commonAncestorContainer;
        }, g.getFirstBlockParent = function(e) {
            var t = function(e) {
                return Le(e, !0) ? (e = e ? e.parentNode : null) && t(e) : e;
            };
            return t(e || g.parentNode());
        }, g.insertNodeAt = function(e, t) {
            var n = g.selectedRange(), o = g.cloneSelected();
            if (!o) return !1;
            o.collapse(e), o.insertNode(t), g.selectRange(n);
        }, a = function(e) {
            g.removeMarker(e);
            e = ve("span", {
                id: e,
                className: "sceditor-selection sceditor-ignore",
                style: "display:none;line-height:0"
            }, s);
            return e.innerHTML = " ", e;
        }, g.insertMarkers = function() {
            var e = g.selectedRange(), t = a(c);
            g.removeMarkers(), g.insertNodeAt(!0, t), e && e.collapsed ? t.parentNode.insertBefore(a(u), t.nextSibling) : g.insertNodeAt(!1, a(u));
        }, g.getMarker = function(e) {
            return s.getElementById(e);
        }, g.removeMarker = function(e) {
            e = g.getMarker(e);
            e && be(e);
        }, g.removeMarkers = function() {
            g.removeMarker(c), g.removeMarker(u);
        }, g.saveRange = function() {
            g.insertMarkers();
        }, g.selectRange = function(e) {
            var t, n = r.getSelection(), o = e.endContainer;
            if (e.collapsed && o && !Le(o, !0)) {
                for (t = o.lastChild; t && Ne(t, ".sceditor-ignore"); ) t = t.previousSibling;
                Ne(t, "br") && ((o = s.createRange()).setEndAfter(t), o.collapse(!1), 
                g.compare(e, o)) && (e.setStartBefore(t), e.collapse(!0));
            }
            n && (g.clear(), n.addRange(e));
        }, g.restoreRange = function() {
            var e, t = g.selectedRange(), n = g.getMarker(c), o = g.getMarker(u);
            if (!n || !o || !t) return !1;
            e = n.nextSibling === o, (t = s.createRange()).setStartBefore(n), t.setEndAfter(o), 
            e && t.collapse(!0), g.selectRange(t), g.removeMarkers();
        }, g.selectOuterText = function(e, t) {
            var n = g.cloneSelected();
            if (!n) return !1;
            n.collapse(!1), e = C(n, !0, e), t = C(n, !1, t), n.setStart(e.node, e.offset), 
            n.setEnd(t.node, t.offset), g.selectRange(n);
        }, g.getOuterText = function(e, t) {
            var n = g.cloneSelected();
            return n ? (n.collapse(!e), C(n, e, t).text) : "";
        }, g.replaceKeyword = function(e, t, n, o, r, i) {
            n || e.sort(function(e, t) {
                return e[0].length - t[0].length;
            });
            var a, l, s, c, u, d, f, p = "(^|[\\s    ])", m = e.length, h = r ? 1 : 0, n = o || e[m - 1][0].length;
            for (r && n++, i = i || "", c = (a = g.getOuterText(!0, n)).length, 
            a += i, t && (a += g.getOuterText(!1, n)); m--; ) if (f = (d = e[m][0]).length, 
            s = Math.max(0, c - f - h), l = -1, r ? (u = a.substr(s).match(new RegExp(p + x(d) + p))) && (l = u.index + s + u[1].length) : l = a.indexOf(d, s), 
            -1 < l && l <= c && c <= l + f + h) return g.selectOuterText(u = c - l, f - u - (/^\S/.test(i) ? 1 : 0)), 
            g.insertHTML(e[m][1]), !0;
            return !1;
        }, g.compare = function(e, t) {
            return t = t || g.selectedRange(), e && t ? 0 === e.compareBoundaryPoints(Range.END_TO_END, t) && 0 === e.compareBoundaryPoints(Range.START_TO_START, t) : !e && !t;
        }, g.clear = function() {
            var e = r.getSelection();
            e && (e.removeAllRanges ? e.removeAllRanges() : e.empty && e.empty());
        };
    }
    var S, e = navigator.userAgent, mt = /iPhone|iPod|iPad| wosbrowser\//i.test(e), ht = (L = !!window.document.documentMode, 
    O = "-ms-ime-align" in document.documentElement.style, (n = document.createElement("div")).contentEditable = !0, 
    "contentEditable" in document.documentElement && "true" === n.contentEditable && (n = /Opera Mobi|Opera Mini/i.test(e), 
    /Android/i.test(e) && (n = !0, /Safari/.test(e)) && (n = !(R = /Safari\/(\d+)/.exec(e)) || !R[1] || R[1] < 534), 
    / Silk\//i.test(e) && (n = !(R = /AppleWebKit\/(\d+)/.exec(e)) || !R[1] || R[1] < 534), 
    mt && (n = /OS [0-4](_\d)+ like Mac/i.test(e)), /Firefox/i.test(e) && (n = !1), 
    /OneBrowser/i.test(e) && (n = !1), "UCWEB" === navigator.vendor && (n = !1), 
    !(n = L || O ? !0 : n)));
    const {
        entries: gt,
        setPrototypeOf: D,
        isFrozen: N,
        getPrototypeOf: k,
        getOwnPropertyDescriptor: A
    } = Object;
    let {
        freeze: Ue,
        seal: t,
        create: vt
    } = Object, {
        apply: _,
        construct: M
    } = "undefined" != typeof Reflect && Reflect;
    Ue = Ue || function(e) {
        return e;
    }, t = t || function(e) {
        return e;
    }, _ = _ || function(e, t, n) {
        return e.apply(t, n);
    }, M = M || function(e, t) {
        return new e(...t);
    };
    const yt = o(Array.prototype.forEach), bt = o(Array.prototype.pop), xt = o(Array.prototype.push), wt = o(String.prototype.toLowerCase), Tt = o(String.prototype.toString), Et = o(String.prototype.match), Ct = o(String.prototype.replace), St = o(String.prototype.indexOf), Dt = o(String.prototype.trim), We = o(RegExp.prototype.test), Nt = (S = TypeError, 
    function() {
        for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++) t[n] = arguments[n];
        return M(S, t);
    });
    function o(r) {
        return function(e) {
            for (var t = arguments.length, n = new Array(1 < t ? t - 1 : 0), o = 1; o < t; o++) n[o - 1] = arguments[o];
            return _(r, e, n);
        };
    }
    function Ve(t, n, e) {
        var o, r = 2 < arguments.length && void 0 !== e ? e : wt;
        D && D(t, null);
        let i = n.length;
        for (;i--; ) {
            let e = n[i];
            "string" == typeof e && (o = r(e)) !== e && (N(n) || (n[i] = o), e = o), 
            t[e] = !0;
        }
        return t;
    }
    function je(e) {
        var t, n, o = vt(null);
        for ([ t, n ] of gt(e)) void 0 !== A(e, t) && (Array.isArray(n) ? o[t] = function(t) {
            for (let e = 0; e < t.length; e++) void 0 === A(t, e) && (t[e] = null);
            return t;
        }(n) : n && "object" == typeof n && n.constructor === Object ? o[t] = je(n) : o[t] = n);
        return o;
    }
    function kt(e, t) {
        for (;null !== e; ) {
            var n = A(e, t);
            if (n) {
                if (n.get) return o(n.get);
                if ("function" == typeof n.value) return o(n.value);
            }
            e = k(e);
        }
        return function(e) {
            return console.warn("fallback value for", e), null;
        };
    }
    const At = Ue([ "a", "abbr", "acronym", "address", "area", "article", "aside", "audio", "b", "bdi", "bdo", "big", "blink", "blockquote", "body", "br", "button", "canvas", "caption", "center", "cite", "code", "col", "colgroup", "content", "data", "datalist", "dd", "decorator", "del", "details", "dfn", "dialog", "dir", "div", "dl", "dt", "element", "em", "fieldset", "figcaption", "figure", "font", "footer", "form", "h1", "h2", "h3", "h4", "h5", "h6", "head", "header", "hgroup", "hr", "html", "i", "img", "input", "ins", "kbd", "label", "legend", "li", "main", "map", "mark", "marquee", "menu", "menuitem", "meter", "nav", "nobr", "ol", "optgroup", "option", "output", "p", "picture", "pre", "progress", "q", "rp", "rt", "ruby", "s", "samp", "section", "select", "shadow", "small", "source", "spacer", "span", "strike", "strong", "style", "sub", "summary", "sup", "table", "tbody", "td", "template", "textarea", "tfoot", "th", "thead", "time", "tr", "track", "tt", "u", "ul", "var", "video", "wbr" ]), _t = Ue([ "svg", "a", "altglyph", "altglyphdef", "altglyphitem", "animatecolor", "animatemotion", "animatetransform", "circle", "clippath", "defs", "desc", "ellipse", "filter", "font", "g", "glyph", "glyphref", "hkern", "image", "line", "lineargradient", "marker", "mask", "metadata", "mpath", "path", "pattern", "polygon", "polyline", "radialgradient", "rect", "stop", "style", "switch", "symbol", "text", "textpath", "title", "tref", "tspan", "view", "vkern" ]), Mt = Ue([ "feBlend", "feColorMatrix", "feComponentTransfer", "feComposite", "feConvolveMatrix", "feDiffuseLighting", "feDisplacementMap", "feDistantLight", "feDropShadow", "feFlood", "feFuncA", "feFuncB", "feFuncG", "feFuncR", "feGaussianBlur", "feImage", "feMerge", "feMergeNode", "feMorphology", "feOffset", "fePointLight", "feSpecularLighting", "feSpotLight", "feTile", "feTurbulence" ]), Rt = Ue([ "animate", "color-profile", "cursor", "discard", "font-face", "font-face-format", "font-face-name", "font-face-src", "font-face-uri", "foreignobject", "hatch", "hatchpath", "mesh", "meshgradient", "meshpatch", "meshrow", "missing-glyph", "script", "set", "solidcolor", "unknown", "use" ]), Lt = Ue([ "math", "menclose", "merror", "mfenced", "mfrac", "mglyph", "mi", "mlabeledtr", "mmultiscripts", "mn", "mo", "mover", "mpadded", "mphantom", "mroot", "mrow", "ms", "mspace", "msqrt", "mstyle", "msub", "msup", "msubsup", "mtable", "mtd", "mtext", "mtr", "munder", "munderover", "mprescripts" ]), Ot = Ue([ "maction", "maligngroup", "malignmark", "mlongdiv", "mscarries", "mscarry", "msgroup", "mstack", "msline", "msrow", "semantics", "annotation", "annotation-xml", "mprescripts", "none" ]), It = Ue([ "#text" ]), Ft = Ue([ "accept", "action", "align", "alt", "autocapitalize", "autocomplete", "autopictureinpicture", "autoplay", "background", "bgcolor", "border", "capture", "cellpadding", "cellspacing", "checked", "cite", "class", "clear", "color", "cols", "colspan", "controls", "controlslist", "coords", "crossorigin", "datetime", "decoding", "default", "dir", "disabled", "disablepictureinpicture", "disableremoteplayback", "download", "draggable", "enctype", "enterkeyhint", "face", "for", "headers", "height", "hidden", "high", "href", "hreflang", "id", "inputmode", "integrity", "ismap", "kind", "label", "lang", "list", "loading", "loop", "low", "max", "maxlength", "media", "method", "min", "minlength", "multiple", "muted", "name", "nonce", "noshade", "novalidate", "nowrap", "open", "optimum", "pattern", "placeholder", "playsinline", "poster", "preload", "pubdate", "radiogroup", "readonly", "rel", "required", "rev", "reversed", "role", "rows", "rowspan", "spellcheck", "scope", "selected", "shape", "size", "sizes", "span", "srclang", "start", "src", "srcset", "step", "style", "summary", "tabindex", "title", "translate", "type", "usemap", "valign", "value", "width", "xmlns", "slot" ]), Ht = Ue([ "accent-height", "accumulate", "additive", "alignment-baseline", "ascent", "attributename", "attributetype", "azimuth", "basefrequency", "baseline-shift", "begin", "bias", "by", "class", "clip", "clippathunits", "clip-path", "clip-rule", "color", "color-interpolation", "color-interpolation-filters", "color-profile", "color-rendering", "cx", "cy", "d", "dx", "dy", "diffuseconstant", "direction", "display", "divisor", "dur", "edgemode", "elevation", "end", "fill", "fill-opacity", "fill-rule", "filter", "filterunits", "flood-color", "flood-opacity", "font-family", "font-size", "font-size-adjust", "font-stretch", "font-style", "font-variant", "font-weight", "fx", "fy", "g1", "g2", "glyph-name", "glyphref", "gradientunits", "gradienttransform", "height", "href", "id", "image-rendering", "in", "in2", "k", "k1", "k2", "k3", "k4", "kerning", "keypoints", "keysplines", "keytimes", "lang", "lengthadjust", "letter-spacing", "kernelmatrix", "kernelunitlength", "lighting-color", "local", "marker-end", "marker-mid", "marker-start", "markerheight", "markerunits", "markerwidth", "maskcontentunits", "maskunits", "max", "mask", "media", "method", "mode", "min", "name", "numoctaves", "offset", "operator", "opacity", "order", "orient", "orientation", "origin", "overflow", "paint-order", "path", "pathlength", "patterncontentunits", "patterntransform", "patternunits", "points", "preservealpha", "preserveaspectratio", "primitiveunits", "r", "rx", "ry", "radius", "refx", "refy", "repeatcount", "repeatdur", "restart", "result", "rotate", "scale", "seed", "shape-rendering", "specularconstant", "specularexponent", "spreadmethod", "startoffset", "stddeviation", "stitchtiles", "stop-color", "stop-opacity", "stroke-dasharray", "stroke-dashoffset", "stroke-linecap", "stroke-linejoin", "stroke-miterlimit", "stroke-opacity", "stroke", "stroke-width", "style", "surfacescale", "systemlanguage", "tabindex", "targetx", "targety", "transform", "transform-origin", "text-anchor", "text-decoration", "text-rendering", "textlength", "type", "u1", "u2", "unicode", "values", "viewbox", "visibility", "version", "vert-adv-y", "vert-origin-x", "vert-origin-y", "width", "word-spacing", "wrap", "writing-mode", "xchannelselector", "ychannelselector", "x", "x1", "x2", "xmlns", "y", "y1", "y2", "z", "zoomandpan" ]), Pt = Ue([ "accent", "accentunder", "align", "bevelled", "close", "columnsalign", "columnlines", "columnspan", "denomalign", "depth", "dir", "display", "displaystyle", "encoding", "fence", "frame", "height", "href", "id", "largeop", "length", "linethickness", "lspace", "lquote", "mathbackground", "mathcolor", "mathsize", "mathvariant", "maxsize", "minsize", "movablelimits", "notation", "numalign", "open", "rowalign", "rowlines", "rowspacing", "rowspan", "rspace", "rquote", "scriptlevel", "scriptminsize", "scriptsizemultiplier", "selection", "separator", "separators", "stretchy", "subscriptshift", "supscriptshift", "symmetric", "voffset", "width", "xmlns" ]), zt = Ue([ "xlink:href", "xml:id", "xlink:title", "xml:space", "xmlns:xlink" ]);
    var R = t(/\{\{[\w\W]*|[\w\W]*\}\}/gm), e = t(/<%[\w\W]*|[\w\W]*%>/gm), L = t(/\${[\w\W]*}/gm), O = t(/^data-[\-\w.\u00B7-\uFFFF]/), n = t(/^aria-[\-\w]+$/);
    const Bt = t(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i);
    var I = t(/^(?:\w+script|data):/i), F = t(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g);
    const Ut = t(/^html$/i);
    var Wt = Object.freeze({
        __proto__: null,
        MUSTACHE_EXPR: R,
        ERB_EXPR: e,
        TMPLIT_EXPR: L,
        DATA_ATTR: O,
        ARIA_ATTR: n,
        IS_ALLOWED_URI: Bt,
        IS_SCRIPT_OR_DATA: I,
        ATTR_WHITESPACE: F,
        DOCTYPE_NAME: Ut
    });
    var Vt = function F(e) {
        e = 0 < arguments.length && void 0 !== e ? e : "undefined" == typeof window ? null : window;
        const c = e => F(e);
        if (c.version = "3.0.8", c.removed = [], !e || !e.document || 9 !== e.document.nodeType) return c.isSupported = !1, 
        c;
        let r = e.document;
        const l = r, H = l.currentScript, {
            DocumentFragment: P,
            HTMLTemplateElement: z,
            Node: s,
            Element: B,
            NodeFilter: t,
            NamedNodeMap: U = e.NamedNodeMap || e.MozNamedAttrMap,
            HTMLFormElement: W,
            DOMParser: V,
            trustedTypes: u
        } = e;
        e = B.prototype;
        const j = kt(e, "cloneNode"), $ = kt(e, "nextSibling"), Y = kt(e, "childNodes"), i = kt(e, "parentNode");
        "function" == typeof z && (e = r.createElement("template")).content && e.content.ownerDocument && (r = e.content.ownerDocument);
        let d, f = "";
        const {
            implementation: a,
            createNodeIterator: G,
            createDocumentFragment: q,
            getElementsByTagName: X
        } = r, K = l.importNode;
        let o = {};
        c.isSupported = "function" == typeof gt && "function" == typeof i && a && void 0 !== a.createHTMLDocument;
        const {
            MUSTACHE_EXPR: p,
            ERB_EXPR: m,
            TMPLIT_EXPR: h,
            DATA_ATTR: Z,
            ARIA_ATTR: J,
            IS_SCRIPT_OR_DATA: Q,
            ATTR_WHITESPACE: ee
        } = Wt;
        let te = Wt.IS_ALLOWED_URI, g = null;
        const ne = Ve({}, [ ...At, ..._t, ...Mt, ...Lt, ...It ]);
        let v = null;
        const oe = Ve({}, [ ...Ft, ...Ht, ...Pt, ...zt ]);
        let y = Object.seal(vt(null, {
            tagNameCheck: {
                writable: !0,
                configurable: !1,
                enumerable: !0,
                value: null
            },
            attributeNameCheck: {
                writable: !0,
                configurable: !1,
                enumerable: !0,
                value: null
            },
            allowCustomizedBuiltInElements: {
                writable: !0,
                configurable: !1,
                enumerable: !0,
                value: !1
            }
        })), b = null, re = null, ie = !0, ae = !0, le = !1, se = !0, x = !1, w = !1, ce = !1, ue = !1, T = !1, E = !1, C = !1, de = !0, fe = !1;
        const pe = "user-content-";
        let me = !0, S = !1, n = {}, D = null;
        const he = Ve({}, [ "annotation-xml", "audio", "colgroup", "desc", "foreignobject", "head", "iframe", "math", "mi", "mn", "mo", "ms", "mtext", "noembed", "noframes", "noscript", "plaintext", "script", "style", "svg", "template", "thead", "title", "video", "xmp" ]);
        let ge = null;
        const ve = Ve({}, [ "audio", "video", "img", "source", "image", "track" ]);
        let ye = null;
        const be = Ve({}, [ "alt", "class", "for", "id", "label", "name", "pattern", "placeholder", "role", "summary", "title", "value", "style", "xmlns" ]), N = "http://www.w3.org/1998/Math/MathML", k = "http://www.w3.org/2000/svg", A = "http://www.w3.org/1999/xhtml";
        let _ = A, xe, we = null;
        const Te = Ve({}, [ N, k, A ], Tt);
        let M = null;
        const Ee = [ "application/xhtml+xml", "text/html" ];
        let R = null, L = null;
        function Ce(e) {
            return e instanceof RegExp || e instanceof Function;
        }
        function Se() {
            let e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {};
            if (!L || L !== e) {
                if (e = je(e = e && "object" == typeof e ? e : {}), M = -1 === Ee.indexOf(e.PARSER_MEDIA_TYPE) ? "text/html" : e.PARSER_MEDIA_TYPE, 
                R = "application/xhtml+xml" === M ? Tt : wt, g = "ALLOWED_TAGS" in e ? Ve({}, e.ALLOWED_TAGS, R) : ne, 
                v = "ALLOWED_ATTR" in e ? Ve({}, e.ALLOWED_ATTR, R) : oe, we = "ALLOWED_NAMESPACES" in e ? Ve({}, e.ALLOWED_NAMESPACES, Tt) : Te, 
                ye = "ADD_URI_SAFE_ATTR" in e ? Ve(je(be), e.ADD_URI_SAFE_ATTR, R) : be, 
                ge = "ADD_DATA_URI_TAGS" in e ? Ve(je(ve), e.ADD_DATA_URI_TAGS, R) : ve, 
                D = "FORBID_CONTENTS" in e ? Ve({}, e.FORBID_CONTENTS, R) : he, 
                b = "FORBID_TAGS" in e ? Ve({}, e.FORBID_TAGS, R) : {}, re = "FORBID_ATTR" in e ? Ve({}, e.FORBID_ATTR, R) : {}, 
                n = "USE_PROFILES" in e && e.USE_PROFILES, ie = !1 !== e.ALLOW_ARIA_ATTR, 
                ae = !1 !== e.ALLOW_DATA_ATTR, le = e.ALLOW_UNKNOWN_PROTOCOLS || !1, 
                se = !1 !== e.ALLOW_SELF_CLOSE_IN_ATTR, x = e.SAFE_FOR_TEMPLATES || !1, 
                w = e.WHOLE_DOCUMENT || !1, T = e.RETURN_DOM || !1, E = e.RETURN_DOM_FRAGMENT || !1, 
                C = e.RETURN_TRUSTED_TYPE || !1, ue = e.FORCE_BODY || !1, de = !1 !== e.SANITIZE_DOM, 
                fe = e.SANITIZE_NAMED_PROPS || !1, me = !1 !== e.KEEP_CONTENT, S = e.IN_PLACE || !1, 
                te = e.ALLOWED_URI_REGEXP || Bt, _ = e.NAMESPACE || A, y = e.CUSTOM_ELEMENT_HANDLING || {}, 
                e.CUSTOM_ELEMENT_HANDLING && Ce(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck) && (y.tagNameCheck = e.CUSTOM_ELEMENT_HANDLING.tagNameCheck), 
                e.CUSTOM_ELEMENT_HANDLING && Ce(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck) && (y.attributeNameCheck = e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck), 
                e.CUSTOM_ELEMENT_HANDLING && "boolean" == typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (y.allowCustomizedBuiltInElements = e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements), 
                x && (ae = !1), E && (T = !0), n && (g = Ve({}, It), v = [], !0 === n.html && (Ve(g, At), 
                Ve(v, Ft)), !0 === n.svg && (Ve(g, _t), Ve(v, Ht), Ve(v, zt)), !0 === n.svgFilters && (Ve(g, Mt), 
                Ve(v, Ht), Ve(v, zt)), !0 === n.mathMl) && (Ve(g, Lt), Ve(v, Pt), 
                Ve(v, zt)), e.ADD_TAGS && Ve(g = g === ne ? je(g) : g, e.ADD_TAGS, R), 
                e.ADD_ATTR && Ve(v = v === oe ? je(v) : v, e.ADD_ATTR, R), e.ADD_URI_SAFE_ATTR && Ve(ye, e.ADD_URI_SAFE_ATTR, R), 
                e.FORBID_CONTENTS && Ve(D = D === he ? je(D) : D, e.FORBID_CONTENTS, R), 
                me && (g["#text"] = !0), w && Ve(g, [ "html", "head", "body" ]), 
                g.table && (Ve(g, [ "tbody" ]), delete b.tbody), e.TRUSTED_TYPES_POLICY) {
                    if ("function" != typeof e.TRUSTED_TYPES_POLICY.createHTML) throw Nt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');
                    if ("function" != typeof e.TRUSTED_TYPES_POLICY.createScriptURL) throw Nt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');
                    d = e.TRUSTED_TYPES_POLICY, f = d.createHTML("");
                } else null !== (d = void 0 === d ? function(e, t) {
                    if ("object" != typeof e || "function" != typeof e.createPolicy) return null;
                    let n = null;
                    var o = "data-tt-policy-suffix", t = "dompurify" + ((n = t && t.hasAttribute(o) ? t.getAttribute(o) : n) ? "#" + n : "");
                    try {
                        return e.createPolicy(t, {
                            createHTML(e) {
                                return e;
                            },
                            createScriptURL(e) {
                                return e;
                            }
                        });
                    } catch (e) {
                        return console.warn("TrustedTypes policy " + t + " could not be created."), 
                        null;
                    }
                }(u, H) : d) && "string" == typeof f && (f = d.createHTML(""));
                Ue && Ue(e), L = e;
            }
        }
        function O(t) {
            xt(c.removed, {
                element: t
            });
            try {
                t.parentNode.removeChild(t);
            } catch (e) {
                t.remove();
            }
        }
        function De(e) {
            let t = null, n = null;
            ue ? e = "<remove></remove>" + e : (o = Et(e, /^[\r\n\t ]+/), n = o && o[0]), 
            "application/xhtml+xml" === M && _ === A && (e = '<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>' + e + "</body></html>");
            var o = d ? d.createHTML(e) : e;
            if (_ === A) try {
                t = new V().parseFromString(o, M);
            } catch (e) {}
            if (!t || !t.documentElement) {
                t = a.createDocument(_, "template", null);
                try {
                    t.documentElement.innerHTML = xe ? f : o;
                } catch (e) {}
            }
            return o = t.body || t.documentElement, e && n && o.insertBefore(r.createTextNode(n), o.childNodes[0] || null), 
            _ === A ? X.call(t, w ? "html" : "body")[0] : w ? t.documentElement : o;
        }
        function Ne(e) {
            return G.call(e.ownerDocument || e, e, t.SHOW_ELEMENT | t.SHOW_COMMENT | t.SHOW_TEXT, null);
        }
        function ke(e) {
            return "function" == typeof s && e instanceof s;
        }
        function Ae(t) {
            let n = null;
            if (I("beforeSanitizeElements", t, null), !((e = t) instanceof W) || "string" == typeof e.nodeName && "string" == typeof e.textContent && "function" == typeof e.removeChild && e.attributes instanceof U && "function" == typeof e.removeAttribute && "function" == typeof e.setAttribute && "string" == typeof e.namespaceURI && "function" == typeof e.insertBefore && "function" == typeof e.hasChildNodes) {
                var e = R(t.nodeName);
                if (I("uponSanitizeElement", t, {
                    tagName: e,
                    allowedTags: g
                }), !t.hasChildNodes() || ke(t.firstElementChild) || !We(/<[/\w]/g, t.innerHTML) || !We(/<[/\w]/g, t.textContent)) {
                    if (g[e] && !b[e]) return t instanceof B && !function(e) {
                        let t = i(e);
                        t && t.tagName || (t = {
                            namespaceURI: _,
                            tagName: "template"
                        });
                        var n = wt(e.tagName), o = wt(t.tagName);
                        return we[e.namespaceURI] && (e.namespaceURI === k ? t.namespaceURI === A ? "svg" === n : t.namespaceURI === N ? "svg" === n && ("annotation-xml" === o || Oe[o]) : Boolean(He[n]) : e.namespaceURI === N ? t.namespaceURI === A ? "math" === n : t.namespaceURI === k ? "math" === n && Ie[o] : Boolean(Pe[n]) : e.namespaceURI === A ? !(t.namespaceURI === k && !Ie[o] || t.namespaceURI === N && !Oe[o] || Pe[n]) && (Fe[n] || !He[n]) : "application/xhtml+xml" === M && we[e.namespaceURI]);
                    }(t) || ("noscript" === e || "noembed" === e || "noframes" === e) && We(/<\/no(script|embed|frames)/i, t.innerHTML) ? (O(t), 
                    !0) : (x && 3 === t.nodeType && (n = t.textContent, yt([ p, m, h ], e => {
                        n = Ct(n, e, " ");
                    }), t.textContent !== n) && (xt(c.removed, {
                        element: t.cloneNode()
                    }), t.textContent = n), I("afterSanitizeElements", t, null), 
                    !1);
                    if (!b[e] && _e(e)) {
                        if (y.tagNameCheck instanceof RegExp && We(y.tagNameCheck, e)) return;
                        if (y.tagNameCheck instanceof Function && y.tagNameCheck(e)) return;
                    }
                    if (me && !D[e]) {
                        var o = i(t) || t.parentNode, r = Y(t) || t.childNodes;
                        if (r && o) for (let e = r.length - 1; 0 <= e; --e) o.insertBefore(j(r[e], !0), $(t));
                    }
                }
            }
            return O(t), 1;
        }
        function _e(e) {
            return 0 < e.indexOf("-");
        }
        function Me(n) {
            I("beforeSanitizeAttributes", n, null);
            var o = n.attributes;
            if (o) {
                var r = {
                    attrName: "",
                    attrValue: "",
                    keepAttr: !0,
                    allowedAttributes: v
                };
                let e = o.length;
                for (;e--; ) {
                    var {
                        name: i,
                        namespaceURI: a,
                        value: l
                    } = o[e], s = R(i);
                    let t = "value" === i ? l : Dt(l);
                    if (r.attrName = s, r.attrValue = t, r.keepAttr = !0, r.forceKeepAttr = void 0, 
                    I("uponSanitizeAttribute", n, r), t = r.attrValue, !r.forceKeepAttr && (ze(i, n), 
                    r.keepAttr)) if (!se && We(/\/>/i, t)) ze(i, n); else if (x && yt([ p, m, h ], e => {
                        t = Ct(t, e, " ");
                    }), l = R(n.nodeName), Be(l, s, t)) {
                        if (!fe || "id" !== s && "name" !== s || (ze(i, n), t = pe + t), 
                        d && "object" == typeof u && "function" == typeof u.getAttributeType && !a) switch (u.getAttributeType(l, s)) {
                          case "TrustedHTML":
                            t = d.createHTML(t);
                            break;

                          case "TrustedScriptURL":
                            t = d.createScriptURL(t);
                        }
                        try {
                            a ? n.setAttributeNS(a, i, t) : n.setAttribute(i, t), 
                            bt(c.removed);
                        } catch (e) {}
                    }
                }
                I("afterSanitizeAttributes", n, null);
            }
        }
        function Re(e) {
            var t, n = Ne(e);
            for (I("beforeSanitizeShadowDOM", e, null); t = n.nextNode(); ) I("uponSanitizeShadowNode", t, null), 
            Ae(t) || (t.content instanceof P && Re(t.content), Me(t));
            I("afterSanitizeShadowDOM", e, null);
        }
        const Le = r.createElement("form"), Oe = Ve({}, [ "mi", "mo", "mn", "ms", "mtext" ]), Ie = Ve({}, [ "foreignobject", "desc", "title", "annotation-xml" ]), Fe = Ve({}, [ "title", "style", "font", "a", "script" ]), He = Ve({}, [ ..._t, ...Mt, ...Rt ]), Pe = Ve({}, [ ...Lt, ...Ot ]), ze = function(e, t) {
            try {
                xt(c.removed, {
                    attribute: t.getAttributeNode(e),
                    from: t
                });
            } catch (e) {
                xt(c.removed, {
                    attribute: null,
                    from: t
                });
            }
            if (t.removeAttribute(e), "is" === e && !v[e]) if (T || E) try {
                O(t);
            } catch (e) {} else try {
                t.setAttribute(e, "");
            } catch (e) {}
        }, I = function(e, t, n) {
            o[e] && yt(o[e], e => {
                e.call(c, t, n, L);
            });
        }, Be = function(e, t, n) {
            if (de && ("id" === t || "name" === t) && (n in r || n in Le)) return !1;
            if ((!ae || re[t] || !We(Z, t)) && (!ie || !We(J, t))) if (!v[t] || re[t]) {
                if (!(_e(e) && (y.tagNameCheck instanceof RegExp && We(y.tagNameCheck, e) || y.tagNameCheck instanceof Function && y.tagNameCheck(e)) && (y.attributeNameCheck instanceof RegExp && We(y.attributeNameCheck, t) || y.attributeNameCheck instanceof Function && y.attributeNameCheck(t)) || "is" === t && y.allowCustomizedBuiltInElements && (y.tagNameCheck instanceof RegExp && We(y.tagNameCheck, n) || y.tagNameCheck instanceof Function && y.tagNameCheck(n)))) return !1;
            } else if (!ye[t] && !We(te, Ct(n, ee, "")) && ("src" !== t && "xlink:href" !== t && "href" !== t || "script" === e || 0 !== St(n, "data:") || !ge[e]) && (!le || We(Q, Ct(n, ee, ""))) && n) return !1;
            return !0;
        };
        return c.sanitize = function(e) {
            var t, n = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {};
            let o = null, r = null;
            if ("string" != typeof (e = (xe = !e) ? "\x3c!--\x3e" : e) && !ke(e)) {
                if ("function" != typeof e.toString) throw Nt("toString is not a function");
                if ("string" != typeof (e = e.toString())) throw Nt("dirty is not a string, aborting");
            }
            if (!c.isSupported) return e;
            if (ce || Se(n), c.removed = [], S = "string" != typeof e && S) {
                if (e.nodeName) {
                    n = R(e.nodeName);
                    if (!g[n] || b[n]) throw Nt("root node is forbidden and cannot be sanitized in-place");
                }
            } else if (e instanceof s) 1 === (n = (o = De("\x3c!----\x3e")).ownerDocument.importNode(e, !0)).nodeType && "BODY" === n.nodeName || "HTML" === n.nodeName ? o = n : o.appendChild(n); else {
                if (!T && !x && !w && -1 === e.indexOf("<")) return d && C ? d.createHTML(e) : e;
                if (!(o = De(e))) return T ? null : C ? f : "";
            }
            o && ue && O(o.firstChild);
            for (var i = Ne(S ? e : o); t = i.nextNode(); ) Ae(t) || (t.content instanceof P && Re(t.content), 
            Me(t));
            if (S) return e;
            if (T) {
                if (E) for (r = q.call(o.ownerDocument); o.firstChild; ) r.appendChild(o.firstChild); else r = o;
                return r = v.shadowroot || v.shadowrootmode ? K.call(l, r, !0) : r;
            }
            let a = w ? o.outerHTML : o.innerHTML;
            return w && g["!doctype"] && o.ownerDocument && o.ownerDocument.doctype && o.ownerDocument.doctype.name && We(Ut, o.ownerDocument.doctype.name) && (a = "<!DOCTYPE " + o.ownerDocument.doctype.name + ">\n" + a), 
            x && yt([ p, m, h ], e => {
                a = Ct(a, e, " ");
            }), d && C ? d.createHTML(a) : a;
        }, c.setConfig = function() {
            var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {};
            Se(e), ce = !0;
        }, c.clearConfig = function() {
            L = null, ce = !1;
        }, c.isValidAttribute = function(e, t, n) {
            return L || Se({}), e = R(e), t = R(t), Be(e, t, n);
        }, c.addHook = function(e, t) {
            "function" == typeof t && (o[e] = o[e] || [], xt(o[e], t));
        }, c.removeHook = function(e) {
            if (o[e]) return bt(o[e]);
        }, c.removeHooks = function(e) {
            o[e] && (o[e] = []);
        }, c.removeAllHooks = function() {
            o = {};
        }, c;
    }(), He = window, Pe = document, jt = /^image\/(p?jpe?g|gif|png|bmp)$/i;
    function $t(e, t) {
        var n;
        p(e, function(e) {
            Le(e, !0) ? (n || e.nodeType === ge ? /\S/.test(e.nodeValue) : !Ne(e, ".sceditor-ignore")) && (n || ke(n = ve("p", {}, t), e), 
            xe(n, e)) : n = null;
        }, !1, !0);
    }
    function ze(r, e) {
        var a, b, u, i, o, d, f, l, x, s, c, p, t, m, h, g, v, y, F, H, n, w, P, z, T, E, B, U, W, V, j, $, Y, G, q, X, K, Z, J, C, Q, ee, te, ne, oe, S, re, D, ie, ae, le, se, N, ce, k, ue, A, _ = this, M = {}, R = [], L = {}, de = {}, O = (_.commands = Ye(!0, {}, e.commands || Fe), 
        _.opts = Ye(!0, {}, dt, e)), fe = (Array.isArray(O.allowedIframeUrls) || (O.allowedIframeUrls = []), 
        O.allowedIframeUrls.push("https://youtube.com/embed/"), Vt());
        function I(e) {
            var t = [ "iframe" ].concat(O.allowedTags), n = [ "allowfullscreen", "frameborder", "target" ].concat(O.allowedAttributes);
            return fe.sanitize(e, {
                ADD_TAGS: t,
                ADD_ATTR: n
            });
        }
        fe.addHook("uponSanitizeElement", function(e, t) {
            var n = O.allowedIframeUrls;
            if ("iframe" === t.tagName) {
                for (var o = Ce(e, "src") || "", r = 0; r < n.length; r++) {
                    var i = n[r];
                    if (pe(i) && o.substr(0, i.length) === i) return;
                    if (i.test && i.test(o)) return;
                }
                be(e);
            }
        }), fe.addHook("afterSanitizeAttributes", function(e) {
            "target" in e && Ce(e, "data-sce-target", Ce(e, "target")), Se(e, "target");
        }), e = function() {
            r._sceditor = _, O.locale && "en" !== O.locale && W(), ke(b = ve("div", {
                className: "sceditor-container card"
            }), r), De(b, "z-index", O.zIndex), H = r.required, r.required = !1;
            function e() {
                Ee(He, "load", e), O.autofocus && le(!!O.autofocusEnd), A(), D(), 
                h.call("ready"), "onReady" in a && a.onReady.call(_);
            }
            var t = ze.formats[O.format];
            a = t ? new t() : {}, h = new ft(_), (O.plugins || "").split(",").forEach(function(e) {
                h.register(e.trim());
            }), "init" in a && a.init.call(_), V(), U(), j(), $(), ht || _.toggleSourceMode(), 
            S();
            Te(He, "load", e), "complete" === Pe.readyState && e();
        }, W = function() {
            var e;
            (t = ze.locale[O.locale]) || (e = O.locale.split("-"), t = ze.locale[e[0]]), 
            t && t.dateFormat && (O.dateFormat = t.dateFormat);
        }, U = function() {
            l = ve("textarea"), i = ve("iframe", {
                frameborder: 0,
                allowfullscreen: !0
            }), _e(x = ve("div"), "card-footer"), _e(x, "text-body-secondary"), 
            _e(x, "text-end"), _e(x, "small"), _e(x, "p-2"), x.appendChild(nt(_._("Characters remaining:") + '<span id="editor-Counter" class="badge bg-secondary ms-1"></span>')), 
            O.startInSourceMode ? (_e(b, "sourceMode"), qe(i)) : (_e(b, "wysiwygMode"), 
            qe(l)), O.spellcheck || Ce(b, "spellcheck", "false"), "https:" === He.location.protocol && Ce(i, "src", "about:blank"), 
            Ce(l, "title", "source"), xe(b, i), xe(b, l), xe(b, x), _.dimensions(O.width || Je(r), O.height || Re(r)), 
            (f = i.contentDocument).open();
            var t = "", e = (O.styles.forEach(e => {
                t += Ie("style", {
                    style: e
                });
            }), f.write(Ie("html", {
                spellcheck: O.spellcheck ? "" : 'spellcheck="false"',
                charset: O.charset,
                themeMode: O.themeMode,
                styles: t
            })), f.close(), d = f.body, o = i.contentWindow, _.readOnly(!!O.readOnly), 
            mt && (Re(d, "100%"), Te(d, "touchend", _.focus)), Ce(r, "tabindex")), e = (Ce(l, "tabindex", e), 
            Ce(i, "tabindex", e), m = new pt(o, null, I), qe(r), _.val(r.value), 
            O.placeholder || Ce(r, "placeholder"));
            e && (l.placeholder = e, Ce(d, "placeholder", e));
        }, j = function() {
            O.autoUpdate && (Te(d, "blur", ue), Te(l, "blur", ue)), null === O.rtl && (O.rtl = "rtl" === De(l, "direction")), 
            _.rtl(!!O.rtl), O.autoExpand && (Te(d, "load", A, !0), Te(d, "input keyup", A)), 
            O.resizeEnabled && Y(), Ce(b, "id", O.id);
        }, $ = function() {
            var e = r.form, t = "compositionstart compositionend", n = "keydown keyup keypress focus blur contextmenu input", o = "onselectionchange" in f ? "selectionchange" : "keyup focus blur contextmenu mouseup touchend click";
            Te(Pe, "click", ne), e && (Te(e, "reset", C), Te(e, "submit", _.updateOriginal, !0)), 
            Te(window, "pagehide", _.updateOriginal), Te(window, "pageshow", C), 
            Te(d, "keypress", J), Te(d, "keydown", K), Te(d, "keydown", Z), Te(d, "keyup", D), 
            Te(d, "blur", ce), Te(d, "keyup", k), Te(d, "paste", G), Te(d, "cut copy", q), 
            Te(d, t, ee), Te(d, o, ie), Te(d, n, te), Te(d, "blur", function() {
                _.val() || _e(d, "placeholder");
            }), Te(d, "focus", function() {
                Ze(d, "placeholder");
            }), Te(l, "blur", ce), Te(l, "keyup", k), Te(l, "keydown", K), Te(l, t, ee), 
            Te(l, n, te), Te(f, "mousedown", Q), Te(f, o, ie), Te(f, "keyup", D), 
            Te(b, "selectionchanged", ae), Te(b, "selectionchanged", S), Te(b, "selectionchanged valuechanged nodechanged pasteraw paste", te);
        }, V = function() {
            var i, a = _.commands, l = (O.toolbarExclude || "").split(","), e = O.toolbar.split("|");
            u = ve("div", {
                className: "card-header btn-toolbar",
                unselectable: "on"
            }), O.icons in ze.icons && (E = new ze.icons[O.icons]()), me(e, function(e, t) {
                i = ve("div", {
                    className: "btn-group btn-group-sm m-1"
                }), me(t.split(","), function(e, t) {
                    var n, o, r = a[t];
                    !r || -1 < l.indexOf(t) || (n = r.shortcut, o = Ie("toolbarButton", {
                        name: t
                    }, !0).firstChild, "source" === t ? o.classList.add("btn-secondary") : o.classList.add("btn-primary"), 
                    E && E.create && E.create(t) && ke(E.create(t), o.firstChild), 
                    o._sceTxtMode = !!r.txtExec, o._sceWysiwygMode = !!r.exec, Me(o, "disabled", !r.exec), 
                    Te(o, "click", function(e) {
                        Ae(o, "disabled") || B(o, r), S(), e.preventDefault();
                    }), Te(o, "mousedown", function(e) {
                        _.closeDropDown(), e.preventDefault();
                    }), r.tooltip && Ce(o, "title", _._(r.tooltip) + (n ? " (" + n + ")" : "")), 
                    n && _.addShortcut(n, t), r.state ? R.push({
                        name: t,
                        state: r.state
                    }) : pe(r.exec) && R.push({
                        name: t,
                        state: r.exec
                    }), xe(i, o), de[t] = o);
                }), i.firstChild && xe(u, i);
            }), xe(O.toolbarContainer || b, u);
        }, Y = function() {
            var e = ve("div", {
                className: "sceditor-grip"
            }), t = "touchmove mousemove", n = "touchcancel touchend mouseup", o = 0, r = 0, i = 0, a = 0, l = 0, s = 0, c = Je(b), u = Re(b), d = !1, f = _.rtl(), p = O.resizeMinHeight || u / 1.5, m = O.resizeMaxHeight || 2.5 * u, h = O.resizeMinWidth || c / 1.25, g = O.resizeMaxWidth || 1.25 * c, v = function(e) {
                a = ("touchmove" === e.type ? (e = He.event, i = e.changedTouches[0].pageX, 
                e.changedTouches[0]) : (i = e.pageX, e)).pageY;
                var t = s + (a - r), n = f ? l - (i - o) : l + (i - o);
                0 < g && g < n && (n = g), 0 < h && n < h && (n = h), O.resizeWidth || (n = !1), 
                0 < m && m < t && (t = m), 0 < p && t < p && (t = p), O.resizeHeight || (t = !1), 
                (n || t) && _.dimensions(n, t), e.preventDefault();
            }, y = function(e) {
                d && (d = !1, Ze(b, "resizing"), Ee(Pe, t, v), Ee(Pe, n, y), e.preventDefault());
            };
            E && E.create && (u = E.create("grip")) && xe(e, u), xe(b, x), xe(b, e), 
            Te(e, "touchstart mousedown", function(e) {
                r = ("touchstart" === e.type ? (e = He.event, o = e.touches[0].pageX, 
                e.touches[0]) : (o = e.pageX, e)).pageY, l = Je(b), s = Re(b), d = !0, 
                _e(b, "resizing"), Te(Pe, t, v), Te(Pe, n, y), e.preventDefault();
            });
        }, le = function(e) {
            var t, n = d.firstChild;
            if (et(b)) if (_.sourceMode()) t = e ? l.value.length : 0, l.setSelectionRange(t, t); else {
                if (lt(d), e) for ((n = d.lastChild) || (n = ve("p", {}, f), xe(d, n)); n.lastChild; ) Ne(n = n.lastChild, "br") && n.previousSibling && (n = n.previousSibling);
                t = f.createRange(), it(n) ? t.selectNodeContents(n) : (t.setStartBefore(n), 
                e && t.setStartAfter(n)), t.collapse(!e), m.selectRange(t), y = t, 
                e && (d.scrollTop = d.scrollHeight), _.focus();
            }
        }, _.readOnly = function(e) {
            return "boolean" != typeof e ? !l.readonly : (d.contentEditable = !e, 
            l.readonly = !e, oe(e), _);
        }, _.rtl = function(e) {
            var t = e ? "rtl" : "ltr";
            return "boolean" != typeof e ? "rtl" === Ce(l, "dir") : (Ce(d, "dir", t), 
            Ce(l, "dir", t), Ze(b, "rtl"), Ze(b, "ltr"), _e(b, t), E && E.rtl && E.rtl(e), 
            _);
        }, oe = function(n) {
            var o = _.inSourceMode() ? "_sceTxtMode" : "_sceWysiwygMode";
            me(de, function(e, t) {
                Me(t, "disabled", n || !t[o]);
            });
        }, _.width = function(e, t) {
            return e || 0 === e ? (_.dimensions(e, null, t), _) : Je(b);
        }, _.dimensions = function(e, t, n) {
            return t = !(!t && 0 !== t) && t, !1 === (e = !(!e && 0 !== e) && e) && !1 === t ? {
                width: _.width(),
                height: _.height()
            } : (!1 !== e && (!1 !== n && (O.width = e), Je(b, e)), !1 !== t && (!1 !== n && (O.height = t), 
            Re(b, t)), _);
        }, _.height = function(e, t) {
            return e || 0 === e ? (_.dimensions(null, e, t), _) : Re(b);
        }, _.maximize = function(e) {
            var t = "sceditor-maximize";
            return Be(e) ? Ae(b, t) : ((e = !!e) && (z = He.scrollY), Me(Pe.documentElement, t, e), 
            Me(Pe.body, t, e), Me(b, t, e), _.width(e ? "100%" : O.width, !1), _.height(e ? "100%" : O.height, !1), 
            e || He.scrollTo(0, z), A(), _);
        }, A = function() {
            O.autoExpand && !P && (P = setTimeout(_.expandToContent, 200));
        }, _.expandToContent = function(e) {
            var t, n;
            _.maximize() || (clearTimeout(P), P = !1, w || (n = O.resizeMinHeight || O.height || Re(r), 
            w = {
                min: n,
                max: O.resizeMaxHeight || 2 * n
            }), (n = Pe.createRange()).selectNodeContents(d), n = n.getBoundingClientRect(), 
            t = f.documentElement.clientHeight - 1, n = n.bottom - n.top, n = _.height() + 1 + (n - t), 
            e || -1 === w.max || (n = Math.min(n, w.max)), _.height(Math.ceil(Math.max(n, w.min))));
        }, _.destroy = function() {
            var e;
            h && (h.destroy(), h = m = null, s && be(s), Ee(Pe, "click", ne), (e = r.form) && (Ee(e, "reset", C), 
            Ee(e, "submit", _.updateOriginal, !0)), Ee(window, "pagehide", _.updateOriginal), 
            Ee(window, "pageshow", C), be(l), be(u), be(b), delete r._sceditor, 
            Xe(r), r.required = H);
        }, _.createDropDown = function(e, t, n) {
            var t = "sceditor-" + t;
            _.closeDropDown(), s && Ae(s, t) || (e = Ye({
                top: e.offsetTop,
                left: e.parentElement.offsetLeft + e.offsetLeft,
                marginTop: e.clientHeight
            }, O.dropDownCss), De(s = ve("div", {
                className: "dropdown-menu show sceditor-dropdown " + t
            }), e), xe(s, n), xe(b, s), Te(s, "click focusin", function(e) {
                e.stopPropagation();
            }), s && (t = we(s, "input,textarea")[0]) && t.focus());
        }, ne = function(e) {
            3 !== e.which && s && !e.defaultPrevented && (ue(), _.closeDropDown());
        }, q = function(e) {
            var t = m.selectedRange();
            if (t) {
                for (var n, o, r = ve("div", {}, f), i = t.commonAncestorContainer; i && Le(i, !0); ) i.nodeType === he && (o = i.cloneNode(), 
                r.firstChild && xe(o, r.firstChild), xe(r, o), n = n || o), i = i.parentNode;
                xe(n || r, t.cloneContents()), lt(r), e.clipboardData.setData("text/html", r.innerHTML), 
                me(we(r, "p"), function(e, t) {
                    rt(t, "div");
                }), me(we(r, "br"), function(e, t) {
                    t.nextSibling && Le(t.nextSibling, !0) || be(t);
                }), xe(d, r), e.clipboardData.setData("text/plain", r.innerText), 
                be(r), "cut" === e.type && t.deleteContents(), e.preventDefault();
            }
        }, G = function(e) {
            var t, n, o = d, r = e.clipboardData;
            if (r) {
                var i = {}, a = r.types, l = r.items;
                e.preventDefault();
                for (var s = 0; s < a.length; s++) {
                    if (a.indexOf("text/html") < 0 && He.FileReader && l && jt.test(l[s].type)) return t = r.items[s].getAsFile(), 
                    n = void 0, (n = new FileReader()).onload = function(e) {
                        X({
                            html: '<img src="' + e.target.result + '" />'
                        });
                    }, void n.readAsDataURL(t);
                    i[a[s]] = r.getData(a[s]);
                }
                i.text = i["text/plain"], i.html = I(i["text/html"]), X(i);
            } else if (!T) {
                var c = o.scrollTop;
                for (m.saveRange(), T = Pe.createDocumentFragment(); o.firstChild; ) xe(T, o.firstChild);
                setTimeout(function() {
                    var e = o.innerHTML;
                    o.innerHTML = "", xe(o, T), o.scrollTop = c, T = !1, m.restoreRange(), 
                    X({
                        html: I(e)
                    });
                }, 0);
            }
        }, X = function(e) {
            var t = ve("div", {}, f), e = (h.call("pasteRaw", e), Qe(b, "pasteraw", e), 
            e.html ? (t.innerHTML = I(e.html), at(t)) : t.innerHTML = Oe(e.text || ""), 
            {
                val: t.innerHTML
            }), t = ("fragmentToSource" in a && (e.val = a.fragmentToSource(e.val, f, g)), 
            h.call("paste", e), Qe(b, "paste", e), "fragmentToHtml" in a && (e.val = a.fragmentToHtml(e.val, g)), 
            h.call("pasteHtml", e), m.getFirstBlockParent());
            _.wysiwygEditorInsertHtml(e.val, null, !0), function e(t) {
                if (t.nodeType === he) {
                    for (var n = t.parentNode, o = t.tagName, r = t.childNodes.length; r--; ) e(t.childNodes[r]);
                    if (Le(t) && "BR" !== o) {
                        for (r = t.style.length; r--; ) {
                            var i = t.style[r];
                            De(n, i) === De(t, i) && t.style.removeProperty(i);
                        }
                        if (!t.style.length) if (Se(t, "style"), "FONT" === o && (De(t, "fontFamily").toLowerCase() === De(n, "fontFamily").toLowerCase() && Se(t, "face"), 
                        De(t, "color") === De(n, "color") && Se(t, "color"), De(t, "fontSize") === De(n, "fontSize")) && Se(t, "size"), 
                        !t.attributes.length && /SPAN|FONT/.test(o)) ut(t); else if (/B|STRONG|EM|SPAN|FONT/.test(o)) for (var a = /B|STRONG/.test(o), l = "EM" === o; n && Le(n) && (!a || /bold|700/i.test(De(n, "fontWeight"))) && (!l || "italic" === De(n, "fontStyle")); ) {
                            if ((n.tagName === o || a && /B|STRONG/.test(n.tagName)) && ct(n, t)) {
                                ut(t);
                                break;
                            }
                            n = n.parentNode;
                        }
                        var s = t.nextSibling;
                        s && s.tagName === o && ct(s, t) && (xe(t, s), ut(s));
                    }
                }
            }(t);
        }, _.closeDropDown = function(e) {
            s && (be(s), s = null), !0 === e && _.focus();
        }, _.wysiwygEditorInsertHtml = function(e, t, n) {
            var o = Re(i);
            _.focus(), !n && ye(v, "code") || (m.insertHTML(e, t), m.saveRange(), 
            at(d), $t(d, f), Xe(n = we(d, "#sceditor-end-marker")[0]), e = d.scrollTop, 
            t = st(n).top + 1.5 * n.offsetHeight - o, qe(n), (e < t || t + o < e) && (d.scrollTop = t), 
            N(!1), m.restoreRange(), D());
        }, _.wysiwygEditorInsertText = function(e, t) {
            _.wysiwygEditorInsertHtml(Oe(e), Oe(t));
        }, _.insertText = function(e, t) {
            return _.inSourceMode() ? _.sourceEditorInsertText(e, t) : _.wysiwygEditorInsertText(e, t), 
            _;
        }, _.sourceEditorInsertText = function(e, t) {
            var n, o = l.selectionStart, r = l.selectionEnd, i = l.scrollTop;
            l.focus(), n = l.value, t && (e += n.substring(o, r) + t), l.value = n.substring(0, o) + e + n.substring(r, n.length), 
            l.selectionStart = o + e.length - (t ? t.length : 0), l.selectionEnd = l.selectionStart, 
            l.scrollTop = i, l.focus(), N();
        }, _.getRangeHelper = function() {
            return m;
        }, _.sourceEditorCaret = function(e) {
            return l.focus(), e ? (l.selectionStart = e.start, l.selectionEnd = e.end, 
            this) : {
                start: l.selectionStart,
                end: l.selectionEnd
            };
        }, _.val = function(e, t) {
            return pe(e) ? (_.inSourceMode() ? _.setSourceEditorValue(e) : (!1 !== t && "toHtml" in a && (e = a.toHtml(e)), 
            _.setWysiwygEditorValue(e)), _) : _.inSourceMode() ? _.getSourceEditorValue(!1) : _.getWysiwygEditorValue(t);
        }, _.insert = function(e, t, n, o, r) {
            var i;
            return _.inSourceMode() ? _.sourceEditorInsertText(e, t) : (t && (i = m.selectedHtml(), 
            e += (i = !1 !== n && "fragmentToSource" in a ? a.fragmentToSource(i, f, g) : i) + t), 
            !1 !== n && "fragmentToHtml" in a && (e = a.fragmentToHtml(e, g)), !1 !== n && !0 === r && (e = e.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&")), 
            _.wysiwygEditorInsertHtml(e)), _;
        }, _.getWysiwygEditorValue = function(e) {
            for (var t, n = ve("div", {}, f), o = d.childNodes, r = 0; r < o.length; r++) xe(n, o[r].cloneNode(!0));
            return xe(d, n), at(n), be(n), t = n.innerHTML, t = !1 !== e && a.hasOwnProperty("toSource") ? a.toSource(t, f) : t;
        }, _.getBody = function() {
            return d;
        }, _.getContentAreaContainer = function() {
            return i;
        }, _.getSourceEditorValue = function(e) {
            var t = l.value;
            return t = !1 !== e && "toHtml" in a ? a.toHtml(t) : t;
        }, _.setWysiwygEditorValue = function(e) {
            d.innerHTML = I(e = e || "<p><br /></p>"), D(), N(), A();
        }, _.setSourceEditorValue = function(e) {
            l.value = e, N();
        }, _.updateOriginal = function() {
            r.value = _.val();
        }, _.inSourceMode = function() {
            return Ae(b, "sourceMode");
        }, _.sourceMode = function(e) {
            var t = _.inSourceMode();
            return "boolean" != typeof e ? t : ((t && !e || !t && e) && _.toggleSourceMode(), 
            _);
        }, _.toggleSourceMode = function() {
            var e = _.inSourceMode();
            !ht && e || (e || (m.saveRange(), m.clear()), y = null, _.blur(), e ? _.setWysiwygEditorValue(_.getSourceEditorValue()) : _.setSourceEditorValue(_.getWysiwygEditorValue()), 
            Ke(l), Ke(i), Me(b, "wysiwygMode", e), Me(b, "sourceMode", !e), oe(), 
            S());
        }, re = function() {
            return l.focus(), l.value.substring(l.selectionStart, l.selectionEnd);
        }, B = function(e, t) {
            _.inSourceMode() ? t.txtExec && (Array.isArray(t.txtExec) ? _.sourceEditorInsertText.apply(_, t.txtExec) : t.txtExec.call(_, e, re())) : t.exec && ($e(t.exec) ? t.exec.call(_, e) : _.execCommand(t.exec, t.hasOwnProperty("execParam") ? t.execParam : null));
        }, _.execCommand = function(e, t) {
            var n = !1, o = _.commands[e];
            if (_.focus(), !ye(m.parentNode(), "code")) {
                try {
                    n = f.execCommand(e, !1, t);
                } catch (e) {}
                !n && o && o.errorMessage && alert(_._(o.errorMessage)), S();
            }
        }, ie = function() {
            function e() {
                if (o.getSelection() && o.getSelection().rangeCount <= 0) y = null; else if (m && !m.compare(y)) {
                    if ((y = m.cloneSelected()) && y.collapsed) {
                        var e = y.startContainer, t = y.startOffset;
                        for (t && e.nodeType !== ge && (e = e.childNodes[t]); e && e.parentNode !== d; ) e = e.parentNode;
                        e && Le(e, !0) && (m.saveRange(), $t(d, f), m.restoreRange());
                    }
                    Qe(b, "selectionchanged");
                }
                F = !1;
            }
            F || (F = !0, "onselectionchange" in f ? e() : setTimeout(e, 100));
        }, ae = function() {
            var e, t = m.parentNode();
            g !== t && (e = g, g = t, v = m.getFirstBlockParent(t), Qe(b, "nodechanged", {
                oldNode: e,
                newNode: g
            }));
        }, _.currentNode = function() {
            return g;
        }, _.currentBlockNode = function() {
            return v;
        }, S = function() {
            var e, t, n = "active", o = f, r = _.sourceMode();
            if (_.readOnly()) me(we(u, n), function(e, t) {
                Ze(t, n);
            }); else {
                r || (t = m.parentNode(), e = m.getFirstBlockParent(t));
                for (var i = 0; i < R.length; i++) {
                    var a = 0, l = de[R[i].name], s = R[i].state, c = r && !l._sceTxtMode || !r && !l._sceWysiwygMode;
                    if (pe(s)) {
                        if (!r) try {
                            -1 < (a = o.queryCommandEnabled(s) ? 0 : -1) && (a = o.queryCommandState(s) ? 1 : 0);
                        } catch (e) {}
                    } else c || (a = s.call(_, t, e));
                    Me(l, "disabled", c || a < 0), Me(l, n, 0 < a);
                }
                E && E.update && E.update(r, t, e);
            }
        }, J = function(e) {
            var t, n, o;
            e.defaultPrevented || (_.closeDropDown(), 13 === e.which && !Ne(v, "li,ul,ol") && ot(v) && (t = ve("br", {}, f), 
            m.insertNode(t), (o = (n = t.parentNode).lastChild) && o.nodeType === ge && "" === o.nodeValue && (be(o), 
            o = n.lastChild), !Le(n, !0) && o === t && Le(t.previousSibling) && m.insertHTML("<br>"), 
            e.preventDefault()));
        }, D = function() {
            tt(d, function(e) {
                var t;
                if (e.nodeType === he && !/inline/.test(De(e, "display")) && (!Ne(e, ".sceditor-nlf") && ot(e))) return (t = ve("p", {}, f)).className = "sceditor-nlf", 
                t.innerHTML = "<br />", xe(d, t), !1;
                if (3 === e.nodeType && !/^\s*$/.test(e.nodeValue) || Ne(e, "br")) return !1;
            });
        }, C = function() {
            _.val(r.value);
        }, Q = function() {
            _.closeDropDown();
        }, _._ = function() {
            var n = arguments;
            return t && t[n[0]] && (n[0] = t[n[0]]), n[0].replace(/\{(\d+)\}/g, function(e, t) {
                return void 0 !== n[+t + 1] ? n[+t + 1] : "{" + t + "}";
            });
        }, te = function(t) {
            h && h.call(t.type + "Event", t, _);
            var e = (t.target === l ? "scesrc" : "scewys") + t.type;
            M[e] && M[e].forEach(function(e) {
                e.call(_, t);
            });
        }, _.bind = function(e, t, n, o) {
            for (var r, i, a = (e = e.split(" ")).length; a--; ) $e(t) && (r = "scewys" + e[a], 
            i = "scesrc" + e[a], n || (M[r] = M[r] || [], M[r].push(t)), o || (M[i] = M[i] || [], 
            M[i].push(t)), "valuechanged" === e[a]) && (N.hasHandler = !0);
            return _;
        }, _.unbind = function(e, t, n, o) {
            for (var r = (e = e.split(" ")).length; r--; ) $e(t) && (n || Ge(M["scewys" + e[r]] || [], t), 
            o || Ge(M["scesrc" + e[r]] || [], t));
            return _;
        }, _.blur = function(e, t, n) {
            return $e(e) ? _.bind("blur", e, t, n) : (_.sourceMode() ? l : d).blur(), 
            _;
        }, _.focus = function(e, t, n) {
            if ($e(e)) _.bind("focus", e, t, n); else if (_.inSourceMode()) l.focus(); else {
                if (we(f, ":focus").length) return;
                e = m.selectedRange();
                y || le(!0), e && 1 === e.endOffset && e.collapsed && (t = e.endContainer) && 1 === t.childNodes.length && Ne(t.firstChild, "br") && (e.setStartBefore(t.firstChild), 
                e.collapse(!0), m.selectRange(e)), o.focus(), d.focus();
            }
            return S(), _;
        }, _.keyDown = function(e, t, n) {
            return _.bind("keydown", e, t, n);
        }, _.keyPress = function(e, t, n) {
            return _.bind("keypress", e, t, n);
        }, _.keyUp = function(e, t, n) {
            return _.bind("keyup", e, t, n);
        }, _.nodeChanged = function(e) {
            return _.bind("nodechanged", e, !1, !0);
        }, _.selectionChanged = function(e) {
            return _.bind("selectionchanged", e, !1, !0);
        }, _.valueChanged = function(e, t, n) {
            return _.bind("valuechanged", e, t, n);
        }, _.css = function(e) {
            return n || (n = ve("style", {
                id: "inline"
            }, f), xe(f.head, n)), pe(e) ? (n.styleSheet ? n.styleSheet.cssText = e : n.innerHTML = e, 
            _) : n.styleSheet ? n.styleSheet.cssText : n.innerHTML;
        }, K = function(e) {
            var t = [], n = {
                "`": "~",
                1: "!",
                2: "@",
                3: "#",
                4: "$",
                5: "%",
                6: "^",
                7: "&",
                8: "*",
                9: "(",
                0: ")",
                "-": "_",
                "=": "+",
                ";": ": ",
                "'": '"',
                ",": "<",
                ".": ">",
                "/": "?",
                "\\": "|",
                "[": "{",
                "]": "}"
            }, o = {
                109: "-",
                110: "del",
                111: "/",
                96: "0",
                97: "1",
                98: "2",
                99: "3",
                100: "4",
                101: "5",
                102: "6",
                103: "7",
                104: "8",
                105: "9"
            }, r = e.which, i = {
                8: "backspace",
                9: "tab",
                13: "enter",
                19: "pause",
                20: "capslock",
                27: "esc",
                32: "space",
                33: "pageup",
                34: "pagedown",
                35: "end",
                36: "home",
                37: "left",
                38: "up",
                39: "right",
                40: "down",
                45: "insert",
                46: "del",
                91: "win",
                92: "win",
                93: "select",
                96: "0",
                97: "1",
                98: "2",
                99: "3",
                100: "4",
                101: "5",
                102: "6",
                103: "7",
                104: "8",
                105: "9",
                106: "*",
                107: "+",
                109: "-",
                110: ".",
                111: "/",
                112: "f1",
                113: "f2",
                114: "f3",
                115: "f4",
                116: "f5",
                117: "f6",
                118: "f7",
                119: "f8",
                120: "f9",
                121: "f10",
                122: "f11",
                123: "f12",
                144: "numlock",
                145: "scrolllock",
                186: ";",
                187: "=",
                188: ",",
                189: "-",
                190: ".",
                191: "/",
                192: "`",
                219: "[",
                220: "\\",
                221: "]",
                222: "'"
            }[r] || String.fromCharCode(r).toLowerCase();
            (e.ctrlKey || e.metaKey) && t.push("ctrl"), e.altKey && t.push("alt"), 
            e.shiftKey && (t.push("shift"), o[r] ? i = o[r] : n[i] && (i = n[i])), 
            i && (r < 16 || 18 < r) && t.push(i), t = t.join("+"), L[t] && !1 === L[t].call(_) && (e.stopPropagation(), 
            e.preventDefault());
        }, _.addShortcut = function(e, t) {
            return e = e.toLowerCase(), pe(t) ? L[e] = function() {
                return B(de[t], _.commands[t]), !1;
            } : L[e] = t, _;
        }, _.removeShortcut = function(e) {
            return delete L[e.toLowerCase()], _;
        }, Z = function(e) {
            var t, n, o;
            if (!O.disableBlockRemove && 8 === e.which && (n = m.selectedRange()) && (t = n.startContainer, 
            0 === n.startOffset) && (o = se()) && !Ne(o, "body")) {
                for (;t !== o; ) {
                    for (;t.previousSibling; ) if ((t = t.previousSibling).nodeType !== ge || t.nodeValue) return;
                    if (!(t = t.parentNode)) return;
                }
                _.clearBlockFormatting(o), e.preventDefault();
            }
        }, se = function() {
            for (var e = v; !ot(e) || Le(e, !0); ) if (!(e = e.parentNode) || Ne(e, "body")) return;
            return e;
        }, _.clearBlockFormatting = function(e) {
            return (e = e || se()) && !Ne(e, "body") && (m.saveRange(), e.className = "", 
            Ce(e, "style", ""), Ne(e, "p,div,td") || rt(e, "p"), m.restoreRange()), 
            _;
        }, N = function(e) {
            var t, n, o;
            h && (h.hasHandler("valuechangedEvent") || N.hasHandler) && (o = !(n = _.sourceMode()) && m.hasSelection(), 
            e = (c = !1) !== e && !f.getElementById("sceditor-start-marker"), p && (clearTimeout(p), 
            p = !1), o && e && m.saveRange(), (t = n ? l.value : d.innerHTML) !== N.lastVal && (N.lastVal = t, 
            Qe(b, "valuechanged", {
                rawValue: n ? _.val() : t
            })), o) && e && m.removeMarkers();
        }, ce = function() {
            p && N();
        }, k = function(e) {
            var e = e.which, t = k.lastChar, n = 13 === t || 32 === t, t = 8 === t || 46 === t;
            k.lastChar = e, c || (13 === e || 32 === e ? n ? k.triggerNext = !0 : N() : 8 === e || 46 === e ? t ? k.triggerNext = !0 : N() : k.triggerNext && (N(), 
            k.triggerNext = !1), clearTimeout(p), p = setTimeout(function() {
                c || N();
            }, 1500));
        }, ee = function(e) {
            (c = /start/i.test(e.type)) || N();
        }, ue = function() {
            _.updateOriginal();
        }, e();
    }
    ze.locale = {}, ze.formats = {}, ze.icons = {}, ze.command = {
        get: function(e) {
            return Fe[e] || null;
        },
        set: function(e, t) {
            return !(!e || !t) && ((t = Ye(Fe[e] || {}, t)).remove = function() {
                ze.command.remove(e);
            }, Fe[e] = t, this);
        },
        remove: function(e) {
            return Fe[e] && delete Fe[e], this;
        }
    }, window.sceditor = {
        command: ze.command,
        commands: Fe,
        defaultOptions: dt,
        ios: mt,
        isWysiwygSupported: ht,
        regexEscape: x,
        escapeEntities: Oe,
        escapeUriScheme: function(e) {
            var t, n = window.location;
            return e && /^[^\/]*:/i.test(e) && !b.test(e) ? ((t = n.pathname.split("/")).pop(), 
            n.protocol + "//" + n.host + t.join("/") + "/" + e) : e;
        },
        dom: {
            css: De,
            attr: Ce,
            removeAttr: Se,
            is: Ne,
            closest: ye,
            width: Je,
            height: Re,
            traverse: p,
            rTraverse: tt,
            parseHTML: nt,
            hasStyling: ot,
            convertElement: rt,
            blockLevelList: m,
            canHaveChildren: it,
            isInline: Le,
            copyCSS: function(e, t) {
                t.style && e.style && (t.style.cssText = e.style.cssText + t.style.cssText);
            },
            fixNesting: at,
            findCommonAncestor: function(e, t) {
                for (;e = e.parentNode; ) if ((n = e) !== (o = t) && n.contains && n.contains(o)) return e;
                var n, o;
            },
            getSibling: g,
            removeWhiteSpace: lt,
            extractContents: v,
            getOffset: st,
            getStyle: y,
            hasStyle: function(e, t, n) {
                return !!(e = y(e, t)) && (!n || e === n || Array.isArray(n) && -1 < n.indexOf(e));
            }
        },
        locale: ze.locale,
        icons: ze.icons,
        utils: {
            each: me,
            isEmptyObject: l,
            extend: Ye
        },
        plugins: ft.plugins,
        formats: ze.formats,
        create: function(e, t) {
            t = t || {}, u(e, ".sceditor-container") || (t.runWithoutWysiwygSupport || ht) && new ze(e, t);
        },
        instance: function(e) {
            return e._sceditor;
        }
    };
}();

(function(sceditor) {
    "use strict";
    var escapeEntities = sceditor.escapeEntities;
    var escapeUriScheme = sceditor.escapeUriScheme;
    var dom = sceditor.dom;
    var utils = sceditor.utils;
    var css = dom.css;
    var attr = dom.attr;
    var is = dom.is;
    var extend = utils.extend;
    var each = utils.each;
    var getEditorCommand = sceditor.command.get;
    var QuoteType = {
        always: 1,
        never: 2,
        auto: 3
    };
    var defaultCommandsOverrides = {
        bold: {
            txtExec: [ "[b]", "[/b]" ]
        },
        italic: {
            txtExec: [ "[i]", "[/i]" ]
        },
        underline: {
            txtExec: [ "[u]", "[/u]" ]
        },
        strike: {
            txtExec: [ "[s]", "[/s]" ]
        },
        mark: {
            txtExec: [ "[h]", "[/h]" ]
        },
        left: {
            txtExec: [ "[left]", "[/left]" ]
        },
        center: {
            txtExec: [ "[center]", "[/center]" ]
        },
        right: {
            txtExec: [ "[right]", "[/right]" ]
        },
        justify: {
            txtExec: [ "[justify]", "[/justify]" ]
        },
        font: {
            txtExec: function(caller) {
                var editor = this;
                getEditorCommand("font")._dropDown(editor, caller, function(fontName) {
                    editor.insertText("[font=" + fontName + "]", "[/font]");
                });
            }
        },
        size: {
            txtExec: function(caller) {
                var editor = this;
                getEditorCommand("size")._dropDown(editor, caller, function(fontSize) {
                    editor.insertText("[size=" + fontSize + "]", "[/size]");
                });
            }
        },
        color: {
            txtExec: function(caller) {
                var editor = this;
                getEditorCommand("color")._dropDown(editor, caller, function(color) {
                    editor.insertText("[color=" + color + "]", "[/color]");
                });
            }
        },
        bulletlist: {
            txtExec: function(caller, selected) {
                this.insertText("[ul]\n[li]" + selected.split(/\r?\n/).join("[/li]\n[li]") + "[/li]\n[/ul]");
            }
        },
        orderedlist: {
            txtExec: function(caller, selected) {
                this.insertText("[ol]\n[li]" + selected.split(/\r?\n/).join("[/li]\n[li]") + "[/li]\n[/ol]");
            }
        },
        code: {
            txtExec: function(caller) {
                var editor = this;
                getEditorCommand("code")._dropDown(editor, caller, function(language) {
                    editor.insertText("[code=" + language + "]", "[/code]");
                });
            }
        },
        extensions: {
            txtExec: function(caller) {
                var editor = this;
                getEditorCommand("extensions")._dropDown(editor, caller, function(extension) {
                    editor.insertText("[" + extension + "]", "[/" + extension + "]");
                });
            }
        },
        image: {
            txtExec: function(caller, selected) {
                var editor = this;
                getEditorCommand("image")._dropDown(editor, caller, function(url, text) {
                    if (text || selected) {
                        editor.insertText("[img=" + url + "]" + (text || selected || url) + "[/img]");
                    } else {
                        editor.insertText(`[img]${url}[/img]`);
                    }
                });
            }
        },
        email: {
            txtExec: function(caller, selected) {
                var editor = this;
                getEditorCommand("email")._dropDown(editor, caller, function(url, text) {
                    editor.insertText("[email=" + url + "]" + (text || selected || url) + "[/email]");
                });
            }
        },
        link: {
            txtExec: function(caller, selected) {
                var editor = this;
                getEditorCommand("link")._dropDown(editor, caller, function(url, text) {
                    if (selected || text) {
                        editor.insertText("[url=" + url + "]" + (text || selected || url) + "[/url]");
                    } else {
                        editor.insertText(`[url]${url}[/url]`);
                    }
                });
            }
        },
        quote: {
            txtExec: [ "[quote]", "[/quote]" ]
        },
        albums: {
            txtExec: function(caller) {
                var editor = this;
                getEditorCommand("albums")._dropDown(editor, caller, function(url) {
                    editor.insertText("[albumid]" + url + "[/albumid]");
                });
            }
        },
        attachments: {
            txtExec: function(caller) {
                var editor = this;
                getEditorCommand("attachments")._dropDown(editor, caller, function(url) {
                    editor.insertText("[attach]" + url + "[/attach]");
                });
            }
        },
        media: {
            txtExec: function(caller) {
                var editor = this;
                getEditorCommand("media")._dropDown(editor, caller, function(url) {
                    editor.insertText("[media]" + url + "[/media]");
                });
            }
        },
        youtube: {
            txtExec: function(caller) {
                var editor = this;
                getEditorCommand("youtube")._dropDown(editor, caller, function(id) {
                    editor.insertText(`[youtube]https://www.youtube.com/watch?v=${id}[/youtube]`);
                });
            }
        }
    };
    var bbcodeHandlers = {
        b: {
            tags: {
                b: null,
                strong: null
            },
            styles: {
                "font-weight": [ "bold", "bolder", "401", "700", "800", "900" ]
            },
            format: "[b]{0}[/b]",
            html: "<strong>{0}</strong>"
        },
        i: {
            tags: {
                i: null,
                em: null
            },
            styles: {
                "font-style": [ "italic", "oblique" ]
            },
            format: "[i]{0}[/i]",
            html: "<em>{0}</em>"
        },
        u: {
            tags: {
                u: null
            },
            styles: {
                "text-decoration": [ "underline" ]
            },
            format: "[u]{0}[/u]",
            html: "<u>{0}</u>"
        },
        s: {
            tags: {
                s: null,
                strike: null
            },
            styles: {
                "text-decoration": [ "line-through" ]
            },
            format: "[s]{0}[/s]",
            html: "<s>{0}</s>"
        },
        sub: {
            tags: {
                sub: null
            },
            format: "[sub]{0}[/sub]",
            html: "<sub>{0}</sub>"
        },
        sup: {
            tags: {
                sup: null
            },
            format: "[sup]{0}[/sup]",
            html: "<sup>{0}</sup>"
        },
        h: {
            tags: {
                h: null,
                mark: null
            },
            format: "[h]{0}[/h]",
            html: "<mark>{0}</mark>"
        },
        font: {
            tags: {
                font: {
                    face: null
                }
            },
            styles: {
                "font-family": null
            },
            quoteType: QuoteType.never,
            format: function(element, content) {
                var font;
                if (!is(element, "font") || !(font = attr(element, "face"))) {
                    font = css(element, "font-family");
                }
                return "[font=" + _stripQuotes(font) + "]" + content + "[/font]";
            },
            html: '<font face="{defaultattr}">{0}</font>'
        },
        size: {
            tags: {
                font: {
                    size: null
                }
            },
            styles: {
                "font-size": null
            },
            format: function(element, content) {
                var fontSize = attr(element, "size"), size = 2;
                if (!fontSize) {
                    fontSize = css(element, "fontSize");
                }
                if (fontSize.indexOf("px") > -1) {
                    fontSize = fontSize.replace("px", "") - 0;
                    if (fontSize < 12) {
                        size = 1;
                    }
                    if (fontSize > 15) {
                        size = 3;
                    }
                    if (fontSize > 17) {
                        size = 4;
                    }
                    if (fontSize > 23) {
                        size = 5;
                    }
                    if (fontSize > 31) {
                        size = 6;
                    }
                    if (fontSize > 47) {
                        size = 7;
                    }
                } else {
                    size = fontSize;
                }
                return "[size=" + size + "]" + content + "[/size]";
            },
            html: '<font size="{defaultattr}">{!0}</font>'
        },
        color: {
            tags: {
                font: {
                    color: null
                }
            },
            styles: {
                color: null
            },
            quoteType: QuoteType.never,
            format: function(elm, content) {
                var color;
                if (!is(elm, "font") || !(color = attr(elm, "color"))) {
                    color = elm.style.color || css(elm, "color");
                }
                return "[color=" + _normaliseColour(color) + "]" + content + "[/color]";
            },
            html: function(token, attrs, content) {
                return '<font color="' + escapeEntities(_normaliseColour(attrs.defaultattr), true) + '">' + content + "</font>";
            }
        },
        ul: {
            tags: {
                ul: null
            },
            breakStart: true,
            isInline: false,
            skipLastLineBreak: true,
            format: "[ul]{0}[/ul]",
            html: "<ul>{0}</ul>"
        },
        list: {
            breakStart: true,
            isInline: false,
            skipLastLineBreak: true,
            html: "<ul>{0}</ul>"
        },
        ol: {
            tags: {
                ol: null
            },
            breakStart: true,
            isInline: false,
            skipLastLineBreak: true,
            format: "[ol]{0}[/ol]",
            html: "<ol>{0}</ol>"
        },
        li: {
            tags: {
                li: null
            },
            isInline: false,
            closedBy: [ "/ul", "/ol", "/list", "*", "li" ],
            format: "[li]{0}[/li]",
            html: "<li>{0}</li>"
        },
        "*": {
            isInline: false,
            closedBy: [ "/ul", "/ol", "/list", "*", "li" ],
            html: "<li>{0}</li>"
        },
        hr: {
            tags: {
                hr: null
            },
            allowsEmpty: true,
            isSelfClosing: true,
            isInline: false,
            format: "[hr]{0}",
            html: "<hr />"
        },
        img: {
            allowsEmpty: true,
            tags: {
                img: {
                    src: null,
                    class: "img-user-posted img-thumbnail"
                }
            },
            allowedChildren: [ "#" ],
            quoteType: QuoteType.never,
            format: function(element) {
                var desc;
                desc = attr(element, "alt");
                if (desc) {
                    return `[img=${attr(element, "src")}]${desc}[/img]`;
                }
                return `[img]${attr(element, "src")}[/img]`;
            },
            html: function(token, attrs, content) {
                attrs.defaultattr = escapeEntities(attrs.defaultattr, true) || content;
                return `<img src="${escapeUriScheme(attrs.defaultattr)}" alt="${content}" class="img-user-posted img-thumbnail" />`;
            }
        },
        albumimg: {
            allowsEmpty: true,
            tags: {
                div: {
                    src: null,
                    class: "card text-bg-dark"
                }
            },
            allowedChildren: [ "#" ],
            quoteType: QuoteType.never,
            format: function(element) {
                return `[albumimg]${attr(element, "alt")}[/albumimg]`;
            },
            html: function(token, attrs, content) {
                attrs.defaultattr = escapeEntities(attrs.defaultattr, true) || content;
                return '<div class="card text-bg-dark" style="max-width:200px" alt="' + content + '">' + '<img src="/api/Albums/GetImagePreview?imageId=' + escapeUriScheme(attrs.defaultattr) + '" class="img-user-posted card-img-top" style="max-height:200px;max-width:200px;object-fit:contain"">' + "</div>";
            }
        },
        url: {
            allowsEmpty: true,
            tags: {
                a: {
                    href: null
                }
            },
            quoteType: QuoteType.never,
            format: function(element, content) {
                var url = attr(element, "href");
                if (url.substr(0, 7) === "mailto:") {
                    return '[email="' + url.substr(7) + '"]' + content + "[/email]";
                }
                return "[url=" + url + "]" + content + "[/url]";
            },
            html: function(token, attrs, content) {
                attrs.defaultattr = escapeEntities(attrs.defaultattr, true) || content;
                return '<a href="' + escapeUriScheme(attrs.defaultattr) + '">' + content + "</a>";
            }
        },
        email: {
            quoteType: QuoteType.never,
            html: function(token, attrs, content) {
                return '<a href="mailto:' + (escapeEntities(attrs.defaultattr, true) || content) + '">' + content + "</a>";
            }
        },
        quote: {
            tags: {
                span: {
                    class: "quote-content"
                }
            },
            isInline: false,
            quoteType: QuoteType.never,
            format: function(element, content) {
                var authorAttr = "data-author";
                var author = "";
                var cite;
                var children = element.children;
                for (var i = 0; !cite && i < children.length; i++) {
                    if (is(children[i], "cite")) {
                        cite = children[i];
                    }
                }
                if (cite || attr(element, authorAttr)) {
                    author = cite && cite.textContent || attr(element, authorAttr);
                    attr(element, authorAttr, author);
                    if (cite) {
                        element.removeChild(cite);
                    }
                    content = this.elementToBbcode(element);
                    author = "=" + author.replace(/(^\s+|\s+$)/g, "");
                    if (cite) {
                        element.insertBefore(cite, element.firstChild);
                    }
                }
                return `[quote${author}]${content}[/quote]`;
            },
            html: function(token, attrs, content) {
                if (attrs.defaultattr) {
                    content = content + '<cite class="card-text text-end d-block"><small class="text-body-secondary">' + escapeEntities(attrs.defaultattr) + "</small></cite>";
                }
                return '<div class="card mx-3 mb-3 border-secondary shadow-sm">' + '<div class="card-body"><p class="card-text">' + '<i class="fa fa-quote-left text-primary fs-4 p-2"></i><span class="quote-content">' + content + "</span></p></div></div>";
            }
        },
        code: {
            tags: {
                code: {
                    class: null
                }
            },
            isInline: false,
            allowedChildren: [ "#", "#newline" ],
            format: function(element, content) {
                var codeLanguage;
                if (!is(element, "code") || !(codeLanguage = attr(element, "class"))) {
                    codeLanguage = element.className.replace("language-", "");
                }
                return "[code=" + codeLanguage.replace("language-", "") + "]" + content + "[/code]";
            },
            html: '<pre class="border border-danger rounded m-2 p-2"><code class="language-{defaultattr}">{0}</code></pre>'
        },
        left: {
            styles: {
                "text-align": [ "left", "-webkit-left", "-moz-left", "-khtml-left" ]
            },
            isInline: false,
            allowsEmpty: true,
            format: "[left]{0}[/left]",
            html: '<div align="left">{0}</div>'
        },
        center: {
            styles: {
                "text-align": [ "center", "-webkit-center", "-moz-center", "-khtml-center" ]
            },
            isInline: false,
            allowsEmpty: true,
            format: "[center]{0}[/center]",
            html: '<div align="center">{0}</div>'
        },
        right: {
            styles: {
                "text-align": [ "right", "-webkit-right", "-moz-right", "-khtml-right" ]
            },
            isInline: false,
            allowsEmpty: true,
            format: "[right]{0}[/right]",
            html: '<div align="right">{0}</div>'
        },
        justify: {
            styles: {
                "text-align": [ "justify", "-webkit-justify", "-moz-justify", "-khtml-justify" ]
            },
            isInline: false,
            allowsEmpty: true,
            format: "[justify]{0}[/justify]",
            html: '<div align="justify">{0}</div>'
        },
        youtube: {
            allowsEmpty: true,
            tags: {
                div: {
                    "data-youtube-id": null
                }
            },
            format: function(element, content) {
                element = attr(element, "data-youtube-id");
                return element ? `[youtube]https://www.youtube.com/watch?v=${element}[/youtube]` : content;
            },
            html: function(token, attrs, content) {
                var id = content.match(/(?:v=|v\/|embed\/|youtu.be\/)?([a-zA-Z0-9_-]{11})/)[1];
                return `<div data-oembed-url="https://youtube.com/embed/${id}" data-youtube-id="${id}" class="ratio ratio-16x9"><iframe src="https://youtube.com/embed/${id}?hd=1"></iframe></div>`;
            }
        },
        rtl: {
            styles: {
                direction: [ "rtl" ]
            },
            isInline: false,
            format: "[rtl]{0}[/rtl]",
            html: '<div style="direction: rtl">{0}</div>'
        },
        ltr: {
            styles: {
                direction: [ "ltr" ]
            },
            isInline: false,
            format: "[ltr]{0}[/ltr]",
            html: '<div style="direction: ltr">{0}</div>'
        },
        ignore: {}
    };
    function formatBBCodeString(str, obj) {
        return str.replace(/\{([^}]+)\}/g, function(match, group) {
            var undef, escape = true;
            if (group.charAt(0) === "!") {
                escape = false;
                group = group.substring(1);
            }
            if (group === "0") {
                escape = false;
            }
            if (obj[group] === undef) {
                return match;
            }
            return escape ? escapeEntities(obj[group], true) : obj[group];
        });
    }
    function isFunction(fn) {
        return typeof fn === "function";
    }
    function _stripQuotes(str) {
        return str ? str.replace(/\\(.)/g, "$1").replace(/^(["'])(.*?)\1$/, "$2") : str;
    }
    function _formatString(str) {
        var undef;
        var args = arguments;
        return str.replace(/\{(\d+)\}/g, function(_, matchNum) {
            return args[matchNum - 0 + 1] !== undef ? args[matchNum - 0 + 1] : "{" + matchNum + "}";
        });
    }
    var TOKEN_OPEN = "open";
    var TOKEN_CONTENT = "content";
    var TOKEN_NEWLINE = "newline";
    var TOKEN_CLOSE = "close";
    function TokenizeToken(type, name, val, attrs, children, closing) {
        var base = this;
        base.type = type;
        base.name = name;
        base.val = val;
        base.attrs = attrs || {};
        base.children = children || [];
        base.closing = closing || null;
    }
    TokenizeToken.prototype = {
        clone: function() {
            var base = this;
            return new TokenizeToken(base.type, base.name, base.val, extend({}, base.attrs), [], base.closing ? base.closing.clone() : null);
        },
        splitAt: function(splitAt) {
            var offsetLength;
            var base = this;
            var clone = base.clone();
            var offset = base.children.indexOf(splitAt);
            if (offset > -1) {
                offsetLength = base.children.length - offset;
                clone.children = base.children.splice(offset, offsetLength);
            }
            return clone;
        }
    };
    function BBCodeParser(options) {
        var base = this;
        base.opts = extend({}, BBCodeParser.defaults, options);
        base.tokenize = function(str) {
            var matches, type, i;
            var tokens = [];
            var tokenTypes = [ {
                type: TOKEN_CONTENT,
                regex: /^([^\[\r\n]+|\[)/
            }, {
                type: TOKEN_NEWLINE,
                regex: /^(\r\n|\r|\n)/
            }, {
                type: TOKEN_OPEN,
                regex: /^\[[^\[\]]+\]/
            }, {
                type: TOKEN_CLOSE,
                regex: /^\[\/[^\[\]]+\]/
            } ];
            strloop: while (str.length) {
                i = tokenTypes.length;
                while (i--) {
                    type = tokenTypes[i].type;
                    if (!(matches = str.match(tokenTypes[i].regex)) || !matches[0]) {
                        continue;
                    }
                    tokens.push(tokenizeTag(type, matches[0]));
                    str = str.substr(matches[0].length);
                    continue strloop;
                }
                if (str.length) {
                    tokens.push(tokenizeTag(TOKEN_CONTENT, str));
                }
                str = "";
            }
            return tokens;
        };
        function tokenizeTag(type, val) {
            var matches, attrs, name, openRegex = /\[([^\]\s=]+)(?:([^\]]+))?\]/, closeRegex = /\[\/([^\[\]]+)\]/;
            if (type === TOKEN_OPEN && (matches = val.match(openRegex))) {
                name = lower(matches[1]);
                if (matches[2] && (matches[2] = matches[2].trim())) {
                    attrs = tokenizeAttrs(matches[2]);
                }
            }
            if (type === TOKEN_CLOSE && (matches = val.match(closeRegex))) {
                name = lower(matches[1]);
            }
            if (type === TOKEN_NEWLINE) {
                name = "#newline";
            }
            if (!name || (type === TOKEN_OPEN || type === TOKEN_CLOSE) && !bbcodeHandlers[name]) {
                type = TOKEN_CONTENT;
                name = "#";
            }
            return new TokenizeToken(type, name, val, attrs);
        }
        function tokenizeAttrs(attrs) {
            var matches, attrRegex = /([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g, ret = {};
            if (attrs.charAt(0) === "=" && attrs.indexOf("=", 1) < 0) {
                ret.defaultattr = _stripQuotes(attrs.substr(1));
            } else {
                if (attrs.charAt(0) === "=") {
                    attrs = "defaultattr" + attrs;
                }
                while (matches = attrRegex.exec(attrs)) {
                    ret[lower(matches[1])] = _stripQuotes(matches[3]) || matches[4];
                }
            }
            return ret;
        }
        base.parse = function(str, preserveNewLines) {
            var ret = parseTokens(base.tokenize(str));
            var opts = base.opts;
            if (opts.fixInvalidNesting) {
                fixNesting(ret);
            }
            normaliseNewLines(ret, null, preserveNewLines);
            if (opts.removeEmptyTags) {
                removeEmpty(ret);
            }
            return ret;
        };
        function hasTag(name, type, arr) {
            var i = arr.length;
            while (i--) {
                if (arr[i].type === type && arr[i].name === name) {
                    return true;
                }
            }
            return false;
        }
        function isChildAllowed(parent, child) {
            var parentBBCode = parent ? bbcodeHandlers[parent.name] : {}, allowedChildren = parentBBCode.allowedChildren;
            if (base.opts.fixInvalidChildren && allowedChildren) {
                return allowedChildren.indexOf(child.name || "#") > -1;
            }
            return true;
        }
        function parseTokens(toks) {
            var token, bbcode, curTok, clone, i, next, cloned = [], output = [], openTags = [], currentTag = function() {
                return last(openTags);
            }, addTag = function(token) {
                if (currentTag()) {
                    currentTag().children.push(token);
                } else {
                    output.push(token);
                }
            }, closesCurrentTag = function(name) {
                return currentTag() && (bbcode = bbcodeHandlers[currentTag().name]) && bbcode.closedBy && bbcode.closedBy.indexOf(name) > -1;
            };
            while (token = toks.shift()) {
                next = toks[0];
                if (!isChildAllowed(currentTag(), token)) {
                    if (token.type !== TOKEN_CLOSE || !currentTag() || token.name !== currentTag().name) {
                        token.name = "#";
                        token.type = TOKEN_CONTENT;
                    }
                }
                switch (token.type) {
                  case TOKEN_OPEN:
                    if (closesCurrentTag(token.name)) {
                        openTags.pop();
                    }
                    addTag(token);
                    bbcode = bbcodeHandlers[token.name];
                    if (bbcode && !bbcode.isSelfClosing && (bbcode.closedBy || hasTag(token.name, TOKEN_CLOSE, toks))) {
                        openTags.push(token);
                    } else if (!bbcode || !bbcode.isSelfClosing) {
                        token.type = TOKEN_CONTENT;
                    }
                    break;

                  case TOKEN_CLOSE:
                    if (currentTag() && token.name !== currentTag().name && closesCurrentTag("/" + token.name)) {
                        openTags.pop();
                    }
                    if (currentTag() && token.name === currentTag().name) {
                        currentTag().closing = token;
                        openTags.pop();
                    } else if (hasTag(token.name, TOKEN_OPEN, openTags)) {
                        while (curTok = openTags.pop()) {
                            if (curTok.name === token.name) {
                                curTok.closing = token;
                                break;
                            }
                            clone = curTok.clone();
                            if (cloned.length) {
                                clone.children.push(last(cloned));
                            }
                            cloned.push(clone);
                        }
                        if (next && next.type === TOKEN_NEWLINE) {
                            bbcode = bbcodeHandlers[token.name];
                            if (bbcode && bbcode.isInline === false) {
                                addTag(next);
                                toks.shift();
                            }
                        }
                        addTag(last(cloned));
                        i = cloned.length;
                        while (i--) {
                            openTags.push(cloned[i]);
                        }
                        cloned.length = 0;
                    } else {
                        token.type = TOKEN_CONTENT;
                        addTag(token);
                    }
                    break;

                  case TOKEN_NEWLINE:
                    if (currentTag() && next && closesCurrentTag((next.type === TOKEN_CLOSE ? "/" : "") + next.name)) {
                        if (!(next.type === TOKEN_CLOSE && next.name === currentTag().name)) {
                            bbcode = bbcodeHandlers[currentTag().name];
                            if (bbcode && bbcode.breakAfter) {
                                openTags.pop();
                            } else if (bbcode && bbcode.isInline === false && base.opts.breakAfterBlock && bbcode.breakAfter !== false) {
                                openTags.pop();
                            }
                        }
                    }
                    addTag(token);
                    break;

                  default:
                    addTag(token);
                    break;
                }
            }
            return output;
        }
        function normaliseNewLines(children, parent, onlyRemoveBreakAfter) {
            var token, left, right, parentBBCode, bbcode, removedBreakEnd, removedBreakBefore, remove;
            var childrenLength = children.length;
            if (parent) {
                parentBBCode = bbcodeHandlers[parent.name];
            }
            var i = childrenLength;
            while (i--) {
                if (!(token = children[i])) {
                    continue;
                }
                if (token.type === TOKEN_NEWLINE) {
                    left = i > 0 ? children[i - 1] : null;
                    right = i < childrenLength - 1 ? children[i + 1] : null;
                    remove = false;
                    if (!onlyRemoveBreakAfter && parentBBCode && parentBBCode.isSelfClosing !== true) {
                        if (!left) {
                            if (parentBBCode.isInline === false && base.opts.breakStartBlock && parentBBCode.breakStart !== false) {
                                remove = true;
                            }
                            if (parentBBCode.breakStart) {
                                remove = true;
                            }
                        } else if (!removedBreakEnd && !right) {
                            if (parentBBCode.isInline === false && base.opts.breakEndBlock && parentBBCode.breakEnd !== false) {
                                remove = true;
                            }
                            if (parentBBCode.breakEnd) {
                                remove = true;
                            }
                            removedBreakEnd = remove;
                        }
                    }
                    if (left && left.type === TOKEN_OPEN) {
                        if (bbcode = bbcodeHandlers[left.name]) {
                            if (!onlyRemoveBreakAfter) {
                                if (bbcode.isInline === false && base.opts.breakAfterBlock && bbcode.breakAfter !== false) {
                                    remove = true;
                                }
                                if (bbcode.breakAfter) {
                                    remove = true;
                                }
                            } else if (bbcode.isInline === false) {
                                remove = true;
                            }
                        }
                    }
                    if (!onlyRemoveBreakAfter && !removedBreakBefore && right && right.type === TOKEN_OPEN) {
                        if (bbcode = bbcodeHandlers[right.name]) {
                            if (bbcode.isInline === false && base.opts.breakBeforeBlock && bbcode.breakBefore !== false) {
                                remove = true;
                            }
                            if (bbcode.breakBefore) {
                                remove = true;
                            }
                            removedBreakBefore = remove;
                            if (remove) {
                                children.splice(i, 1);
                                continue;
                            }
                        }
                    }
                    if (remove) {
                        children.splice(i, 1);
                    }
                    removedBreakBefore = false;
                } else if (token.type === TOKEN_OPEN) {
                    normaliseNewLines(token.children, token, onlyRemoveBreakAfter);
                }
            }
        }
        function fixNesting(children, parents, insideInline, rootArr) {
            var token, i, parent, parentIndex, parentParentChildren, right;
            var isInline = function(token) {
                var bbcode = bbcodeHandlers[token.name];
                return !bbcode || bbcode.isInline !== false;
            };
            parents = parents || [];
            rootArr = rootArr || children;
            for (i = 0; i < children.length; i++) {
                if (!(token = children[i]) || token.type !== TOKEN_OPEN) {
                    continue;
                }
                if (insideInline && !isInline(token)) {
                    parent = last(parents);
                    right = parent.splitAt(token);
                    parentParentChildren = parents.length > 1 ? parents[parents.length - 2].children : rootArr;
                    if (isChildAllowed(token, parent)) {
                        var clone = parent.clone();
                        clone.children = token.children;
                        token.children = [ clone ];
                    }
                    parentIndex = parentParentChildren.indexOf(parent);
                    if (parentIndex > -1) {
                        right.children.splice(0, 1);
                        parentParentChildren.splice(parentIndex + 1, 0, token, right);
                        var next = right.children[0];
                        if (next && next.type === TOKEN_NEWLINE) {
                            if (!isInline(token)) {
                                right.children.splice(0, 1);
                                parentParentChildren.splice(parentIndex + 2, 0, next);
                            }
                        }
                        return;
                    }
                }
                parents.push(token);
                fixNesting(token.children, parents, insideInline || isInline(token), rootArr);
                parents.pop();
            }
        }
        function removeEmpty(tokens) {
            var token, bbcode;
            var isTokenWhiteSpace = function(children) {
                var j = children.length;
                while (j--) {
                    var type = children[j].type;
                    if (type === TOKEN_OPEN || type === TOKEN_CLOSE) {
                        return false;
                    }
                    if (type === TOKEN_CONTENT && /\S|\u00A0/.test(children[j].val)) {
                        return false;
                    }
                }
                return true;
            };
            var i = tokens.length;
            while (i--) {
                if (!(token = tokens[i]) || token.type !== TOKEN_OPEN) {
                    continue;
                }
                bbcode = bbcodeHandlers[token.name];
                removeEmpty(token.children);
                if (isTokenWhiteSpace(token.children) && bbcode && !bbcode.isSelfClosing && !bbcode.allowsEmpty) {
                    tokens.splice.apply(tokens, [ i, 1 ].concat(token.children));
                }
            }
        }
        base.toHTML = function(str, preserveNewLines) {
            return convertToHTML(base.parse(str, preserveNewLines), true);
        };
        base.toHTMLFragment = function(str, preserveNewLines) {
            return convertToHTML(base.parse(str, preserveNewLines), false);
        };
        function convertToHTML(tokens, isRoot) {
            var undef, token, bbcode, content, html, needsBlockWrap, blockWrapOpen, isInline, lastChild, ret = "";
            isInline = function(bbcode) {
                return (!bbcode || (bbcode.isHtmlInline !== undef ? bbcode.isHtmlInline : bbcode.isInline)) !== false;
            };
            while (tokens.length > 0) {
                if (!(token = tokens.shift())) {
                    continue;
                }
                if (token.type === TOKEN_OPEN) {
                    lastChild = token.children[token.children.length - 1] || {};
                    bbcode = bbcodeHandlers[token.name];
                    needsBlockWrap = isRoot && isInline(bbcode);
                    content = convertToHTML(token.children, false);
                    if (bbcode && bbcode.html) {
                        if (!isInline(bbcode) && isInline(bbcodeHandlers[lastChild.name]) && !bbcode.isPreFormatted && !bbcode.skipLastLineBreak) {
                            content += "<br />";
                        }
                        if (!isFunction(bbcode.html)) {
                            token.attrs["0"] = content;
                            html = formatBBCodeString(bbcode.html, token.attrs);
                        } else {
                            html = bbcode.html.call(base, token, token.attrs, content);
                        }
                    } else {
                        html = token.val + content + (token.closing ? token.closing.val : "");
                    }
                } else if (token.type === TOKEN_NEWLINE) {
                    if (!isRoot) {
                        ret += "<br />";
                        continue;
                    }
                    if (!blockWrapOpen) {
                        ret += "<div>";
                    }
                    ret += "<br />";
                    if (!tokens.length) {
                        ret += "<br />";
                    }
                    ret += "</div>\n";
                    blockWrapOpen = false;
                    continue;
                } else {
                    needsBlockWrap = isRoot;
                    html = escapeEntities(token.val, true);
                }
                if (needsBlockWrap && !blockWrapOpen) {
                    ret += "<div>";
                    blockWrapOpen = true;
                } else if (!needsBlockWrap && blockWrapOpen) {
                    ret += "</div>\n";
                    blockWrapOpen = false;
                }
                ret += html;
            }
            if (blockWrapOpen) {
                ret += "</div>\n";
            }
            return ret;
        }
        base.toBBCode = function(str, preserveNewLines) {
            return convertToBBCode(base.parse(str, preserveNewLines));
        };
        function convertToBBCode(toks) {
            var token, attr, bbcode, isBlock, isSelfClosing, quoteType, breakBefore, breakStart, breakEnd, breakAfter, ret = "";
            while (toks.length > 0) {
                if (!(token = toks.shift())) {
                    continue;
                }
                bbcode = bbcodeHandlers[token.name];
                isBlock = !(!bbcode || bbcode.isInline !== false);
                isSelfClosing = bbcode && bbcode.isSelfClosing;
                breakBefore = isBlock && base.opts.breakBeforeBlock && bbcode.breakBefore !== false || bbcode && bbcode.breakBefore;
                breakStart = isBlock && !isSelfClosing && base.opts.breakStartBlock && bbcode.breakStart !== false || bbcode && bbcode.breakStart;
                breakEnd = isBlock && base.opts.breakEndBlock && bbcode.breakEnd !== false || bbcode && bbcode.breakEnd;
                breakAfter = isBlock && base.opts.breakAfterBlock && bbcode.breakAfter !== false || bbcode && bbcode.breakAfter;
                quoteType = (bbcode ? bbcode.quoteType : null) || base.opts.quoteType || QuoteType.auto;
                if (!bbcode && token.type === TOKEN_OPEN) {
                    ret += token.val;
                    if (token.children) {
                        ret += convertToBBCode(token.children);
                    }
                    if (token.closing) {
                        ret += token.closing.val;
                    }
                } else if (token.type === TOKEN_OPEN) {
                    if (breakBefore) {
                        ret += "\n";
                    }
                    ret += "[" + token.name;
                    if (token.attrs) {
                        if (token.attrs.defaultattr) {
                            ret += "=" + quote(token.attrs.defaultattr, quoteType, "defaultattr");
                            delete token.attrs.defaultattr;
                        }
                        for (attr in token.attrs) {
                            if (token.attrs.hasOwnProperty(attr)) {
                                ret += " " + attr + "=" + quote(token.attrs[attr], quoteType, attr);
                            }
                        }
                    }
                    ret += "]";
                    if (breakStart) {
                        ret += "\n";
                    }
                    if (token.children) {
                        ret += convertToBBCode(token.children);
                    }
                    if (!isSelfClosing && !bbcode.excludeClosing) {
                        if (breakEnd) {
                            ret += "\n";
                        }
                        ret += "[/" + token.name + "]";
                    }
                    if (breakAfter) {
                        ret += "\n";
                    }
                    if (token.closing && isSelfClosing) {
                        ret += token.closing.val;
                    }
                } else {
                    ret += token.val;
                }
            }
            return ret;
        }
        function quote(str, quoteType, name) {
            var needsQuotes = /\s|=/.test(str);
            if (isFunction(quoteType)) {
                return quoteType(str, name);
            }
            if (quoteType === QuoteType.never || quoteType === QuoteType.auto && !needsQuotes) {
                return str;
            }
            return '"' + str.replace(/\\/g, "\\\\").replace(/"/g, '\\"') + '"';
        }
        function last(arr) {
            if (arr.length) {
                return arr[arr.length - 1];
            }
            return null;
        }
        function lower(str) {
            return str.toLowerCase();
        }
    }
    BBCodeParser.QuoteType = QuoteType;
    BBCodeParser.defaults = {
        breakBeforeBlock: false,
        breakStartBlock: false,
        breakEndBlock: false,
        breakAfterBlock: true,
        removeEmptyTags: true,
        fixInvalidNesting: true,
        fixInvalidChildren: true,
        quoteType: QuoteType.auto,
        strictMatch: false
    };
    function toHex(number) {
        number = parseInt(number, 10);
        if (isNaN(number)) {
            return "00";
        }
        number = Math.max(0, Math.min(number, 255)).toString(16);
        return number.length < 2 ? "0" + number : number;
    }
    function _normaliseColour(colorStr) {
        var match;
        colorStr = colorStr || "#000";
        if (match = colorStr.match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i)) {
            return "#" + toHex(match[1]) + toHex(match[2]) + toHex(match[3]);
        }
        if (match = colorStr.match(/#([0-9a-f])([0-9a-f])([0-9a-f])\s*?$/i)) {
            return "#" + match[1] + match[1] + match[2] + match[2] + match[3] + match[3];
        }
        return colorStr;
    }
    function bbcodeFormat() {
        var base = this;
        base.stripQuotes = _stripQuotes;
        var tagsToBBCodes = {};
        var validChildren = {
            ul: [ "li", "ol", "ul" ],
            ol: [ "li", "ol", "ul" ],
            table: [ "tr" ],
            tr: [ "td", "th" ],
            code: [ "br", "p", "div" ]
        };
        function buildBbcodeCache() {
            each(bbcodeHandlers, function(bbcode, handler) {
                var isBlock = handler.isInline === false, tags = bbcodeHandlers[bbcode].tags, styles = bbcodeHandlers[bbcode].styles;
                if (styles) {
                    tagsToBBCodes["*"] = tagsToBBCodes["*"] || {};
                    tagsToBBCodes["*"][isBlock] = tagsToBBCodes["*"][isBlock] || {};
                    tagsToBBCodes["*"][isBlock][bbcode] = [ [ "style", Object.entries(styles) ] ];
                }
                if (tags) {
                    each(tags, function(tag, values) {
                        if (values && values.style) {
                            values.style = Object.entries(values.style);
                        }
                        tagsToBBCodes[tag] = tagsToBBCodes[tag] || {};
                        tagsToBBCodes[tag][isBlock] = tagsToBBCodes[tag][isBlock] || {};
                        tagsToBBCodes[tag][isBlock][bbcode] = values && Object.entries(values);
                    });
                }
            });
        }
        function handleBlockNewlines(element, content) {
            var tag = element.nodeName.toLowerCase();
            var isInline = dom.isInline;
            if (!isInline(element, true) || tag === "br") {
                var isLastBlockChild, parent, parentLastChild, previousSibling = element.previousSibling;
                while (previousSibling && previousSibling.nodeType === 1 && !is(previousSibling, "br") && isInline(previousSibling, true) && !previousSibling.firstChild) {
                    previousSibling = previousSibling.previousSibling;
                }
                do {
                    parent = element.parentNode;
                    parentLastChild = parent && parent.lastChild;
                    isLastBlockChild = parentLastChild === element;
                    element = parent;
                } while (parent && isLastBlockChild && isInline(parent, true));
                if (!isLastBlockChild || tag === "li") {
                    content += "\n";
                }
                if (tag !== "br" && previousSibling && !is(previousSibling, "br") && isInline(previousSibling, true)) {
                    content = "\n" + content;
                }
            }
            return content;
        }
        function handleTags(element, content, blockLevel) {
            function isStyleMatch(style) {
                var property = style[0];
                var values = style[1];
                var val = dom.getStyle(element, property);
                var parent = element.parentNode;
                if (!val || parent && dom.hasStyle(parent, property, val)) {
                    return false;
                }
                return !values || values.includes(val);
            }
            function createAttributeMatch(isStrict) {
                return function(attribute) {
                    var name = attribute[0];
                    var value = attribute[1];
                    if (name === "style" && element.nodeName === "CODE") {
                        return false;
                    }
                    if (name === "style" && value) {
                        return value[isStrict ? "every" : "some"](isStyleMatch);
                    } else {
                        var val = attr(element, name);
                        return val && (!value || value.includes(val));
                    }
                };
            }
            function handleTag(tag) {
                if (!tagsToBBCodes[tag] || !tagsToBBCodes[tag][blockLevel]) {
                    return;
                }
                each(tagsToBBCodes[tag][blockLevel], function(bbcode, attrs) {
                    var fn, format, isStrict = bbcodeHandlers[bbcode].strictMatch;
                    if (typeof isStrict === "undefined") {
                        isStrict = base.opts.strictMatch;
                    }
                    fn = isStrict ? "every" : "some";
                    if (attrs && !attrs[fn](createAttributeMatch(isStrict))) {
                        return;
                    }
                    format = bbcodeHandlers[bbcode].format;
                    if (isFunction(format)) {
                        content = format.call(base, element, content);
                    } else {
                        content = _formatString(format, content);
                    }
                    return false;
                });
            }
            handleTag("*");
            handleTag(element.nodeName.toLowerCase());
            return content;
        }
        function elementToBbcode(element, hasCodeParent) {
            var toBBCode = function(node, hasCodeParent, vChildren) {
                var ret = "";
                dom.traverse(node, function(node) {
                    var content = "", nodeType = node.nodeType, tag = node.nodeName.toLowerCase(), isCodeTag = tag === "code", vChild = validChildren[tag], firstChild = node.firstChild, isValidChild = true;
                    if (vChildren) {
                        isValidChild = vChildren.indexOf(tag) > -1;
                        if (!isValidChild) {
                            vChild = vChildren;
                        }
                    }
                    if (nodeType === 1) {
                        if (is(node, ".sceditor-nlf") && !firstChild) {
                            return;
                        }
                        if (tag !== "iframe") {
                            content = toBBCode(node, hasCodeParent || isCodeTag, vChild);
                        }
                        if (isValidChild) {
                            if (!hasCodeParent) {
                                if (!isCodeTag) {
                                    content = handleTags(node, content, false);
                                }
                                content = handleTags(node, content, true);
                            }
                            ret += handleBlockNewlines(node, content);
                        } else {
                            ret += content;
                        }
                    } else if (nodeType === 3) {
                        ret += node.nodeValue;
                    }
                }, false, true);
                return ret;
            };
            return toBBCode(element, hasCodeParent);
        }
        base.init = function() {
            base.opts = this.opts;
            base.elementToBbcode = elementToBbcode;
            buildBbcodeCache();
            this.commands = extend(true, {}, defaultCommandsOverrides, this.commands);
            this.toBBCode = base.toSource;
            this.fromBBCode = base.toHtml;
        };
        function toHtml(asFragment, source, legacyAsFragment) {
            var parser = new BBCodeParser(base.opts.parserOptions);
            var toHTML = asFragment || legacyAsFragment ? parser.toHTMLFragment : parser.toHTML;
            return toHTML(base.opts.bbcodeTrim ? source.trim() : source);
        }
        function toSource(asFragment, html, context, parent) {
            context = context || document;
            var bbcode, elements;
            var hasCodeParent = !!dom.closest(parent, "code");
            var containerParent = context.createElement("div");
            var container = context.createElement("div");
            var parser = new BBCodeParser(base.opts.parserOptions);
            container.innerHTML = html;
            css(containerParent, "visibility", "hidden");
            containerParent.appendChild(container);
            context.body.appendChild(containerParent);
            if (asFragment) {
                containerParent.insertBefore(context.createTextNode("#"), containerParent.firstChild);
                containerParent.appendChild(context.createTextNode("#"));
            }
            if (parent) {
                css(container, "whiteSpace", css(parent, "whiteSpace"));
            }
            elements = container.getElementsByClassName("sceditor-ignore");
            while (elements.length) {
                elements[0].parentNode.removeChild(elements[0]);
            }
            dom.removeWhiteSpace(containerParent);
            bbcode = elementToBbcode(container, hasCodeParent);
            context.body.removeChild(containerParent);
            bbcode = parser.toBBCode(bbcode, true);
            if (base.opts.bbcodeTrim) {
                bbcode = bbcode.trim();
            }
            return bbcode;
        }
        base.toHtml = toHtml.bind(null, false);
        base.fragmentToHtml = toHtml.bind(null, true);
        base.toSource = toSource.bind(null, false);
        base.fragmentToSource = toSource.bind(null, true);
    }
    bbcodeFormat.get = function(name) {
        return bbcodeHandlers[name] || null;
    };
    bbcodeFormat.set = function(name, bbcode) {
        if (name && bbcode) {
            bbcode = extend(bbcodeHandlers[name] || {}, bbcode);
            bbcode.remove = function() {
                delete bbcodeHandlers[name];
            };
            bbcodeHandlers[name] = bbcode;
        }
        return this;
    };
    bbcodeFormat.rename = function(name, newName) {
        if (name in bbcodeHandlers) {
            bbcodeHandlers[newName] = bbcodeHandlers[name];
            delete bbcodeHandlers[name];
        }
        return this;
    };
    bbcodeFormat.remove = function(name) {
        if (name in bbcodeHandlers) {
            delete bbcodeHandlers[name];
        }
        return this;
    };
    bbcodeFormat.formatBBCodeString = formatBBCodeString;
    sceditor.formats.bbcode = bbcodeFormat;
    sceditor.BBCodeParser = BBCodeParser;
})(sceditor);

!function(s) {
    "use strict";
    var f = s.dom, o = {
        albums: '<i class="fa-solid fa-images"></i',
        attachments: '<i class="fa-solid fa-paperclip"></i',
        bold: '<i class="fa-solid fa-bold"></i>',
        bulletlist: '<i class="fa-solid fa-list-ul"></i>',
        center: '<i class="fa-solid fa-align-center"></i>',
        code: '<i class="fa-solid fa-code"></i>',
        color: '<span class="fa-stack me-2 pe-2"><i class="fas fa-font fa-stack-1x"></i><i class="fa fa-xs fa-palette sce-color fa-badge"></i></span>',
        copy: '<i class="fa-solid fa-copy"></i>',
        cut: '<i class="fa-solid fa-scissors"></i>',
        email: '<i class="fa-solid fa-envelope"></i>',
        extensions: '<i class="fa-solid fa-plug"></i>',
        font: '<span class="fa-stack me-2 pe-2"><i class="fas fa-font fa-stack-1x"></i><i class="fa fa-xs fa-font fa-badge"></i></span>',
        format: '<i class="fa-solid fa-font"></i>',
        grip: '<svg xmlns="http://www.w3.org/2000/svg"viewbox="0 0 16 16" unselectable="on"><path d="M14.656 5.156l-10 10 .688.688 10-10-.688-.688zm0 3l-7 7 .688.688 7-7-.688-.688zm0 3l-4 4 .688.688 4-4-.688-.688z"/></svg>',
        mark: '<i class="fa-solid fa-highlighter"></i>',
        horizontalrule: '<i class="fa-solid fa-grip-lines"></i>',
        image: '<i class="fa-solid fa-image"></i>',
        indent: '<i class="fa-solid fa-indent"></i>',
        italic: '<i class="fa-solid fa-italic"></i>',
        justify: '<i class="fa-solid fa-align-justify"></i>',
        left: '<i class="fa-solid fa-align-left"></i>',
        link: '<i class="fa-solid fa-link"></i>',
        maximize: '<i class="fa-solid fa-maximize"></i>',
        media: '<i class="fa-solid fa-photo-film"></i>',
        orderedlist: '<i class="fa-solid fa-list-ol"></i>',
        outdent: '<i class="fa-solid fa-outdent"></i>',
        paste: '<i class="fa-solid fa-paste"></i>',
        pastetext: '<i class="fa-solid fa-paste"></i>',
        quote: '<i class="fa-solid fa-quote-left"></i>',
        redo: '<i class="fa-solid fa-redo"></i>',
        removeformat: '<i class="fa-solid fa-remove-format"></i>',
        right: '<i class="fa-solid fa-align-right"></i>',
        size: '<span class="fa-stack me-2 pe-2"><i class="fas fa-font fa-stack-1x"></i><i class="fa fa-xs fa-up-down fa-badge"></i></span>',
        source: '<i class="fa-solid fa-file-code"></i>',
        strike: '<i class="fa-solid fa-strikethrough"></i>',
        underline: '<i class="fa-solid fa-underline"></i>',
        undo: '<i class="fa-solid fa-undo"></i>',
        unlink: '<i class="fa-solid fa-link-slash"></i>',
        youtube: '<i class="fa-brands fa-youtube"></i>'
    };
    s.icons.fontawesome = function() {
        var l, i = {};
        return {
            create: function(a) {
                return a in o && (i[a] = s.dom.parseHTML(o[a]).firstChild, "color" === a) && (l = i[a].querySelector(".sce-color")), 
                i[a];
            },
            update: function(s, i) {
                if (l) {
                    let a = "inherit";
                    !s && i && (a = i.ownerDocument.queryCommandValue("forecolor")), 
                    f.css(l, "color", a);
                }
            },
            rtl: function(a) {
                var s = i.grip;
                s && (f.css(s, "transform", a = a ? "scaleX(-1)" : ""), f.css(s, "msTransform", a), 
                f.css(s, "webkitTransform", a));
            }
        };
    }, s.icons.fontawesome.icons = o;
}((document, sceditor));

!function(n) {
    "use strict";
    var v = void 0 !== window.FileReader, u = /data:[^;]+;base64,/i;
    n.plugins.dragdrop = function() {
        var a, r, i, A, o, s;
        function d() {
            o.style.display = "none", A.className = A.className.replace(/(^| )dnd( |$)/g, "");
        }
        function l() {
            return 1;
        }
        function f(e) {
            var n = document.createElement("img");
            function t(e) {
                var t = r.getBody().ownerDocument.getElementById(n.id);
                t && ("string" == typeof e && t.insertAdjacentHTML("afterend", e), 
                t.parentNode.removeChild(t));
            }
            return n.src = "data:image/gif;base64,R0lGODlhlgBkAPABAH19ffb29iH5BAAKAAAAIf4aQ3JlYXRlZCB3aXRoIGFqYXhsb2FkLmluZm8AIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAlgBkAAAC1YyPqcvtD6OctNqLs968+w+G4kiW5omm6sq27gvH8kzX9o3n+s73/g8MCofEovGITCqXzKbzCY1Kp9Sq9YrNarfcrvcLDovH5LL5jE6r1+y2+w2Py+f0uv2OvwD2fP6iD/gH6Pc2GIhg2JeQSNjGuLf4GMlYKIloefAIUEl52ZmJyaY5mUhqyFnqmQr6KRoaMKp66hbLumpQ69oK+5qrOyg4a6qYV2x8jJysvMzc7PwMHS09TV1tfY2drb3N3e39DR4uPk5ebn6Onq6+zt7u/g4fL99UAAAh+QQACgAAACwAAAAAlgBkAIEAAAB9fX329vYAAAAC3JSPqcvtD6OctNqLs968+w+G4kiW5omm6sq27gvH8kzX9o3n+s73/g8MCofEovGITCqXzKbzCY1Kp9Sq9YrNarfcrvcLDovH5LL5jE6r1+y2+w2Py+f0uv2OvwD2fP4iABgY+CcoCNeHuJdQyLjIaOiWiOj4CEhZ+SbZd/nI2RipqYhQOThKGpAZCuBZyArZprpqSupaCqtaazmLCRqai7rb2av5W5wqSShcm8fc7PwMHS09TV1tfY2drb3N3e39DR4uPk5ebn6Onq6+zt7u/g4fLz9PX29/j5/vVAAAIfkEAAoAAAAsAAAAAJYAZACBAAAAfX199vb2AAAAAuCUj6nL7Q+jnLTai7PevPsPhuJIluaJpurKtu4Lx/JM1/aN5/rO9/4PDAqHxKLxiEwql8ym8wmNSqfUqvWKzWq33K73Cw6Lx+Sy+YxOq9fstvsNj8vn9Lr9jr8E9nz+AgAYGLjQVwhXiJgguAiYgGjo9tinyCjoKLn3hpmJUGmJsBmguUnpCXCJOZraaXoKShoJe9DqehCqKlnqiZobuzrbyvuIO8xqKpxIPKlwrPCbBx0tPU1dbX2Nna29zd3t/Q0eLj5OXm5+jp6uvs7e7v4OHy8/T19vf4+fr7/P379UAAAh+QQACgAAACwAAAAAlgBkAIEAAAB9fX329vYAAAAC4JSPqcvtD6OctNqLs968+w+G4kiW5omm6sq27gvH8kzX9o3n+s73/g8MCofEovGITCqXzKbzCY1Kp9Sq9YrNarfcrvcLDovH5LL5jE6r1+y2+w2Py+f0uv2OvwT2fP6iD7gAMEhICAeImIAYiFDoOPi22KcouZfw6BhZGUBZeYlp6LbJiTD6CQqg6Vm6eQqqKtkZ24iaKtrKunpQa9tmmju7Wwu7KFtMi3oYDMzompkHHS09TV1tfY2drb3N3e39DR4uPk5ebn6Onq6+zt7u/g4fLz9PX29/j5+vv8/f31QAADs=", 
            n.className = "sceditor-ignore", n.id = "sce-dragdrop-" + s++, function() {
                return e ? e.parentNode.replaceChild(n, e) : r.wysiwygEditorInsertHtml(n.outerHTML), 
                {
                    insert: function(e) {
                        t(e);
                    },
                    cancel: t
                };
            };
        }
        function e(e) {
            var t = e.dataTransfer, n = t.files.length || !t.items ? t.files : t.items;
            for (let e = 0; e < n.length; e++) if ("string" === n[e].kind) return;
            "none" === o.style.display && (o.style.display = "block", A.className += " dnd"), 
            e.preventDefault();
        }
        function t(e) {
            var t = e.dataTransfer, n = t.files.length || !t.items ? t.files : t.items;
            d();
            for (let e = 0; e < n.length; e++) {
                if ("string" === n[e].kind) return;
                l(n[e]), i(n[e], f());
            }
            e.preventDefault();
        }
        v && (s = 0, this.signalReady = function() {
            a = (r = this).opts.dragdrop || {}, i = a.handleFile, A = r.getContentAreaContainer().parentNode, 
            o = A.appendChild(n.dom.parseHTML('<div class="sceditor-dnd-cover" style="display: none"></div>').firstChild), 
            A.addEventListener("dragover", e), A.addEventListener("dragleave", d), 
            A.addEventListener("dragend", d), A.addEventListener("drop", t), r.getBody().addEventListener("dragover", e), 
            r.getBody().addEventListener("drop", d);
        }, this.signalPasteHtml = function(e) {
            if (!("handlePaste" in a) || a.handlePaste) {
                var t = document.createElement("div"), n = (t.innerHTML = e.val, 
                t.querySelectorAll("img"));
                for (let e = 0; e < n.length; e++) {
                    var r, A = n[e];
                    u.test(A.src) && ((r = function(e) {
                        var t = e.substr(5, e.indexOf(";") - 5), n = atob(e.substr(e.indexOf(",") + 1)), r = new Uint8Array(n.length);
                        for (let e = 0; e < n.length; e++) r[e] = n[e].charCodeAt(0);
                        try {
                            return new Blob([ r ], {
                                type: t
                            });
                        } catch (e) {
                            return null;
                        }
                    }(A.src)) ? i(r, f(A)) : A.parentNode.removeChild(A));
                }
                e.val = t.innerHTML;
            }
        });
    };
}(sceditor);

!function() {
    "use strict";
    sceditor.plugins.undo = function() {
        var n, i, a, o, r = this, s = "", c = 0, u = !1, d = !1, l = !1, e = 50, t = [], g = 0;
        function f(e) {
            if (d = !0, i.sourceMode(e.sourceMode), e.sourceMode) i.val(e.value, !1), 
            i.sourceEditorCaret(e.caret); else if (i.getBody().innerHTML = e.value, 
            e.caret) {
                var t = i.getRangeHelper().selectedRange(), n = t, e = e.caret;
                try {
                    var o = e.startPositions, r = e.endPositions;
                    n.setStart(m(a, o), o[0]), n.setEnd(m(a, r), r[0]);
                } catch (e) {
                    console && console.warn && console.warn("[SCEditor] Undo plugin lost caret", e);
                }
                i.getRangeHelper().selectRange(t);
            }
            i.focus(), d = !1;
        }
        function h(e, t) {
            var n = e[t];
            e[t] = function() {
                var e = u;
                !e && !d && o && i.getRangeHelper().hasSelection() && v(), u = !0, 
                n.apply(this, arguments), e || (u = !1, d) || (p(), s = "");
            };
        }
        function p() {
            g && (t.length -= g, g = 0), 0 < e && e < t.length && t.shift(), o = {}, 
            v(), t.push(o);
        }
        function v() {
            var e = i.sourceMode(), e = (o.caret = e ? i.sourceEditorCaret() : function(e) {
                if (e) return a.normalize(), {
                    startPositions: y(e.startContainer, e.startOffset),
                    endPositions: y(e.endContainer, e.endOffset)
                };
            }(i.getRangeHelper().selectedRange()), (o.sourceMode = e) ? i.getSourceEditorValue(!1) : i.getBody().innerHTML), t = document.getElementById("editor-Counter"), n = i.opts.maxLength;
            i.val().length > n ? r.undo() : t.textContent = n - i.val().length, 
            o.value = e;
        }
        function E() {
            n === document.activeElement && r.signalSelectionchangedEvent();
        }
        function y(e, t) {
            for (var n = [ t ], o = e; o && "BODY" !== o.tagName; ) n.push(function(e) {
                var t = 0;
                for (;e = e.previousSibling; ) t++;
                return t;
            }(o)), o = o.parentNode;
            return n;
        }
        function m(t, n) {
            for (let e = n.length - 1; t && 0 < e; e--) t = t.childNodes[n[e]];
            return t;
        }
        r.init = function() {
            e = (i = this).undoLimit || e, i.addShortcut("ctrl+z", r.undo), i.addShortcut("ctrl+shift+z", r.redo), 
            i.addShortcut("ctrl+y", r.redo);
        }, r.signalReady = function() {
            function e(e) {
                "historyUndo" === e.inputType ? (r.undo(), e.preventDefault()) : "historyRedo" === e.inputType && (r.redo(), 
                e.preventDefault());
            }
            function t() {
                s = "", p();
            }
            n = i.getContentAreaContainer().nextSibling, a = i.getBody(), p(), h(i, "setWysiwygEditorValue"), 
            h(i, "setSourceEditorValue"), h(i, "sourceEditorInsertText"), h(i.getRangeHelper(), "insertNode"), 
            h(i, "toggleSourceMode"), a.addEventListener("beforeinput", e), n.addEventListener("beforeinput", e), 
            a.addEventListener("compositionend", t), n.addEventListener("compositionend", t), 
            document.addEventListener("selectionchange", E);
        }, r.destroy = function() {
            document.removeEventListener("selectionchange", E);
        }, r.undo = function() {
            return o = null, g < t.length - 1 && (g++, f(t[t.length - 1 - g])), 
            !1;
        }, r.redo = function() {
            return 0 < g && (g--, f(t[t.length - 1 - g])), !1;
        }, r.signalSelectionchangedEvent = function() {
            d || l ? l = !1 : (o && v(), s = "");
        }, r.signalInputEvent = function(e) {
            var t = e.inputType;
            if (l = !0, t && !e.isComposing) switch (e.inputType) {
              case "deleteContentBackward":
                o && s === t && c < 20 ? v() : (p(), c = 0), s = t;
                break;

              case "insertText":
                c += e.data ? e.data.length : 1, o && s === t && c < 20 && !/\s$/.test(e.data) ? v() : (p(), 
                c = 0), s = t;
                break;

              default:
                s = "sce-misc", c = 0, p();
            }
        };
    };
}();

function mentions(opts = {}) {
    opts = Object.assign({}, {
        lookup: "lookup",
        id: "",
        selector: "",
        element: null,
        symbol: "@",
        items: [],
        item_template: '<a class="dropdown-item" href="#"><img src="${item.avatar}" alt="avatar" class="me-2 img-thumbnail" style="max-width:20px;max-height:20px" /> ${item.name}</a>',
        onclick: undefined,
        url: ""
    }, opts);
    const $e = opts.id && document.getElementById(opts.id) || opts.selector && document.querySelector(opts.selector) || opts.element;
    if (!$e) return console.error("Invalid element selector", opts);
    var $lookup = document.createElement("div");
    $lookup.classList = `fixed-top autohide ${opts.lookup}`;
    $e.parentNode.insertBefore($lookup, $e.nextSibling);
    $e.addEventListener("keydown", processKey);
    $e.addEventListener("keyup", showLookup);
    $e.addEventListener("click", hideLookup);
    var range, start, end, prevWord;
    var isFixed = false;
    var $el = $lookup.parentNode;
    while ($el && $el.nodeName.toLowerCase() !== "body" && !isFixed) {
        isFixed = window.getComputedStyle($el).getPropertyValue("position").toLowerCase() === "fixed";
        $el = $el.parentElement;
    }
    function showLookup(event) {
        if (event.code === "Escape") {
            return hideLookup();
        }
        var sel = window.getSelection();
        var $parent = $lookup.parentNode.querySelector("textarea");
        var text = sel.anchorNode.querySelector("textarea").value || "";
        var curr = $parent.selectionStart;
        var getLength = arr => arr instanceof Array && arr.length > 0 ? arr[0].length : 0;
        start = curr - getLength(text.slice(0, curr).match(/[\S]+$/g));
        end = curr + getLength(text.slice(curr).match(/^[\S]+/g));
        var word = text.substring(start, end);
        if (!word || word[0] !== opts.symbol) {
            prevWord = "";
            return hideLookup();
        }
        if (word === prevWord) return;
        prevWord = word;
        var pos = {
            x: 0,
            y: 0
        };
        var parentRect = $parent.getBoundingClientRect();
        pos.y = parentRect.top + 30;
        pos.x = parentRect.left + 20;
        $lookup.style.left = pos.x + "px";
        $lookup.style.top = pos.y + "px";
        var query = word.slice(1);
        if (query.length >= 3) {
            fetch(opts.url.replace("{q}", query), {
                method: "GET",
                headers: {
                    Accept: "application/json",
                    "Content-Type": "application/json;charset=utf-8",
                    RequestVerificationToken: document.querySelector('input[name="__RequestVerificationToken"]').value
                }
            }).then(response => response.json()).then(data => opts.items = data);
        }
        var items = opts.items.filter(e => e.name.toLowerCase().includes(word.slice(1).toLowerCase())).map(item => eval('`<li class="mention-li-nt ${opts.lookup}" data-name = "${item.name}" data-id = "${item.id}">' + opts.item_template + "</li>`"));
        if (!items.length) return hideLookup();
        $lookup.innerHTML = `<ul class="dropdown-menu show">${items.join("")}</ul>`;
        [ ...$lookup.firstElementChild.children ].forEach($el => $el.addEventListener("click", onClick) || $el.addEventListener("mouseenter", onHover));
        $lookup.firstElementChild.children[0].classList.add("active");
        if ($lookup.hasAttribute("hidden")) $lookup.removeAttribute("hidden");
        var bounding = $lookup.getBoundingClientRect();
        if (!(bounding.top >= 0 && bounding.left >= 0 && bounding.bottom <= (window.innerHeight || document.documentElement.clientHeight) && bounding.right <= (window.innerWidth || document.documentElement.clientWidth))) $lookup.style.top = parseInt($lookup.style.top) - 10 - $lookup.clientHeight + "px";
    }
    function hideLookup() {
        if (!$lookup.hasAttribute("hidden")) $lookup.setAttribute("hidden", true);
    }
    function onClick(event) {
        const deleteItem = event.target.classList.contains("mention-li-nt") ? event.target : event.target.parentElement;
        opts.onclick(deleteItem.dataset);
        const $parent = $lookup.parentNode.querySelector("textarea");
        $parent.value = $parent.value.replace($parent.value.substring(start + 1, end), "");
        hideLookup();
    }
    function onHover(event) {
        const $el = event.target.closest(".mention-li-nt");
        if ($el.classList.contains("active")) return;
        [ ...$lookup.firstElementChild.children ].filter($el => $el.classList.contains("active")).forEach($el => $el.classList.remove("active"));
        $el.classList.add("active");
    }
    function processKey(event) {
        const code = event.key;
        if ([ "ArrowUp", "ArrowDown", "Enter" ].indexOf(code) == -1 || $lookup.hasAttribute("hidden")) return;
        event.preventDefault();
        if (code == "Enter") return $lookup.querySelector(".active").click();
        const $children = [ ...$lookup.firstElementChild.children ];
        const curr = $children.findIndex($el => $el.classList.contains("active"));
        $children[curr].classList.remove("active");
        const $next = $children[($children.length + curr + (code == "ArrowUp" ? -1 : 1)) % $children.length];
        $next.classList.add("active");
        $next.scrollIntoView(false);
    }
}